<!DOCTYPE html>
<html lang="ar" dir="rtl" data-lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" data-i18n-content="metaDescription">
    <title data-i18n="appTitle"></title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* ===========================
           Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙˆØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø¹Ø§Ù…Ø©
        =========================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #ff0000;
            --secondary-color: #282828;
            --bg-dark: #0f0f0f;
            --bg-light: #1f1f1f;
            --text-primary: #ffffff;
            --text-secondary: #aaaaaa;
            --border-color: #303030;
            --success-color: #00ff00;
            --verified-color: #1da1f2;
            --shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        html[data-lang="ar"] body {
            font-family: 'Cairo', sans-serif;
            direction: rtl;
        }

        html[data-lang="en"] body,
        html[data-lang="fr"] body {
            font-family: 'Inter', sans-serif;
            direction: ltr;
        }

        html[data-lang="ja"] body {
            font-family: 'Noto Sans JP', sans-serif;
            direction: ltr;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding: 10px 15px;
            background: var(--bg-light);
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .breadcrumb button {
            background: var(--secondary-color);
            border: 1px solid var(--border-color);
            color: var(--verified-color);
            cursor: pointer;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 6px;
            transition: all 0.3s;
            font-size: 0.9rem;
            font-family: inherit;
        }

        .breadcrumb button:hover {
            background: var(--primary-color);
            color: var(--text-primary);
            border-color: var(--primary-color);
        }

        .library-view {
            margin-bottom: 30px;
        }

        .library-header {
            padding: 15px 20px;
            background: var(--secondary-color);
            border-radius: 12px 12px 0 0;
            border-bottom: 1px solid var(--border-color);
        }

        .library-header h1 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .library-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            padding: 20px;
            background: var(--bg-light);
            border-radius: 0 0 12px 12px;
        }

        .library-item {
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 8px;
            overflow: hidden;
            background: var(--secondary-color);
            border: 2px solid transparent;
        }

        .library-item:hover {
            border-color: var(--primary-color);
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .item-cover {
            width: 100%;
            aspect-ratio: 16 / 9;
            background-color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .item-cover.episode {
            background-size: cover;
            background-position: 25% center;
        }

        .item-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .play-icon {
            position: absolute;
            font-size: 3rem;
            color: rgba(255, 255, 255, 0.9);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.7);
            pointer-events: none;
        }

        .item-info {
            padding: 15px;
        }

        .item-title {
            font-weight: 600;
            margin-bottom: 8px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .item-subtitle {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .video-section {
            background: var(--bg-light);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .video-header {
            padding: 15px 20px;
            background: var(--secondary-color);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .video-header h1 {
            font-size: 1.5rem;
            font-weight: 600;
            flex: 1;
        }

        .video-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            background: #000;
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        .quick-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sys-toggle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: #2a2a2a;
            color: #aaa;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.25s ease;
            box-shadow: inset 0 0 0 2px #333;
            font-family: inherit;
            user-select: none;
        }

        .sys-toggle:hover {
            background: #333;
        }

        .sys-toggle.active {
            background: var(--primary-color);
            color: #fff;
            box-shadow: 0 0 12px rgba(255, 0, 0, 0.6), inset 0 0 0 2px rgba(255,255,255,0.3);
        }

        .control-panel {
            background: var(--secondary-color);
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }

        .dub-notice {
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-align: center;
            padding: 10px 14px;
            line-height: 1.5;
        }

        .control-buttons {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
        }

        .control-btn-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: center;
        }

        .control-btn {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: #1f1f1f;
            border: 2px solid #333;
            color: #fff;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
            position: relative;
        }

        .control-btn:hover:not(:disabled) {
            background: var(--primary-color);
            border-color: var(--primary-color);
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
        }

        .control-btn:active:not(:disabled) {
            transform: scale(0.95);
        }

        .control-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .control-btn-small {
            width: 45px;
            height: 45px;
            font-size: 16px;
            background: #151515;
            border: 2px solid #282828;
        }

        .control-btn-small:hover:not(:disabled) {
            background: #cc0000;
            border-color: #cc0000;
        }

        .btn-label {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 4px;
            font-weight: 500;
        }

        .dub-selector {
            background: var(--secondary-color);
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 0;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                max-height: 0;
                overflow: hidden;
            }
            to {
                opacity: 1;
                max-height: 500px;
            }
        }

        .dub-selector h3 {
            margin-bottom: 12px;
            font-size: 0.95rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .dub-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .dub-btn {
            padding: 10px 18px;
            background: var(--bg-dark);
            border: 2px solid var(--border-color);
            color: var(--text-primary);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s;
            font-family: inherit;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .dub-btn:hover {
            border-color: var(--text-secondary);
            background: var(--bg-light);
        }

        .dub-btn.active {
            border-color: var(--primary-color);
            background: var(--primary-color);
            color: var(--text-primary);
            font-weight: 600;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }

        .dub-icon {
            font-size: 1.1rem;
        }

        .dub-status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            background: rgba(255, 0, 0, 0.1);
            border-radius: 6px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #ff0000;
            border: 1px solid rgba(255, 0, 0, 0.2);
        }

        .dub-status-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #aaa;
            border-radius: 50%;
        }

        .dub-status-dot.active {
            background: var(--success-color);
            animation: pulse 1.5s ease-in-out infinite;
        }

        .video-info {
            padding: 20px;
        }

        .video-title {
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .video-description {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        .comments-section {
            background: var(--bg-light);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .comments-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .comments-header h2 {
            font-size: 1.4rem;
            font-weight: 600;
        }

        .comments-count {
            background: var(--secondary-color);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .comment-form {
            margin-bottom: 30px;
            padding: 20px;
            background: var(--secondary-color);
            border-radius: 8px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            background: var(--bg-dark);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: var(--text-secondary);
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            background: var(--bg-dark);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-hint {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .submit-btn {
            width: 100%;
            padding: 12px;
            background: var(--primary-color);
            color: var(--text-primary);
            border: 1px solid var(--primary-color);
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
        }

        .submit-btn:hover:not(:disabled) {
            background: #cc0000;
            border-color: #cc0000;
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .status-message {
            padding: 12px 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            display: none;
        }

        .status-message.show {
            display: block;
        }

        .status-message.success {
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid var(--success-color);
            color: var(--success-color);
        }

        .status-message.error {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
        }

        .status-message.info {
            background: rgba(29, 161, 242, 0.1);
            border: 1px solid var(--verified-color);
            color: var(--verified-color);
        }

        .comments-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .comment-item {
            background: var(--secondary-color);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            transition: all 0.3s;
            cursor: pointer;
        }

        .comment-item:hover {
            border-color: var(--text-secondary);
        }

        .comment-item.user-comment {
            border: 2px solid var(--primary-color);
            background: rgba(255, 0, 0, 0.05);
        }

        .comment-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .comment-author {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .verified-badge {
            display: inline-flex;
            align-items: center;
            color: var(--verified-color);
        }

        .verified-svg {
            width: 14px;
            height: 14px;
            margin-inline-start: 4px;
        }

        .comment-time {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .comment-text {
            color: var(--text-primary);
            line-height: 1.6;
            word-wrap: break-word;
        }

        .comment-actions {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--border-color);
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .click-count {
            font-weight: 500;
        }

        .no-comments {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: var(--text-secondary);
        }

        .hidden {
            display: none !important;
        }

        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            background: var(--secondary-color);
            color: var(--verified-color);
            border: 1px solid var(--border-color);
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
            font-family: inherit;
            font-weight: 500;
        }

        .back-btn:hover {
            background: var(--primary-color);
            color: var(--text-primary);
            border-color: var(--primary-color);
        }

        #langToggle {
            position: fixed;
            right: 20px;
            bottom: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-color);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 9999;
            font-size: 1.2rem;
            font-weight: 600;
            border: 2px solid var(--text-primary);
            transition: all 0.3s;
            box-shadow: var(--shadow);
            text-align: center;
            padding: 5px;
        }

        #langToggle:hover {
            transform: scale(1.1);
            background: #cc0000;
        }

        #langMenu {
            position: fixed;
            right: 20px;
            bottom: 80px;
            background: var(--bg-light);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            z-index: 9999;
            box-shadow: var(--shadow);
            min-width: 140px;
        }

        #langMenu button {
            display: block;
            width: 100%;
            padding: 12px 16px;
            background: var(--secondary-color);
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            font-size: 0.9rem;
            font-family: inherit;
            font-weight: 500;
        }

        #langMenu button:hover {
            background: var(--primary-color);
            color: var(--text-primary);
        }

        #langMenu button.active {
            background: var(--primary-color);
            color: var(--text-primary);
            font-weight: 700;
        }

        .spinner {
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .comments-update-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: var(--primary-color);
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 1.5s ease-in-out infinite;
        }

        .comments-update-indicator.paused {
            animation: none;
            opacity: 0.5;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .library-item, .comment-item {
            animation: fadeIn 0.3s ease-out;
        }

        /* Privacy Policy Styles */
        .privacy-view {
            margin-bottom: 30px;
        }

        .privacy-header {
            padding: 25px 20px;
            background: linear-gradient(135deg, var(--secondary-color) 0%, #1a1a1a 100%);
            border-radius: 12px 12px 0 0;
            border-bottom: 2px solid var(--primary-color);
            margin-bottom: 20px;
        }

        .privacy-header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--primary-color);
        }

        .privacy-header .last-updated {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .privacy-content {
            background: var(--bg-light);
            padding: 30px;
            border-radius: 0 0 12px 12px;
            box-shadow: var(--shadow);
        }

        .privacy-section {
            margin-bottom: 35px;
            padding-bottom: 25px;
            border-bottom: 1px solid var(--border-color);
        }

        .privacy-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .privacy-section h2 {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .privacy-section h2::before {
            content: '';
            width: 4px;
            height: 25px;
            background: var(--primary-color);
            border-radius: 2px;
        }

        .privacy-section p {
            color: var(--text-primary);
            margin-bottom: 12px;
            line-height: 1.8;
        }

        .privacy-section ul {
            list-style: none;
            margin: 15px 0;
            padding: 0;
        }

        .privacy-section li {
            color: var(--text-primary);
            margin-bottom: 10px;
            padding: 10px 15px;
            background: rgba(255, 0, 0, 0.05);
            border-right: 3px solid var(--primary-color);
            border-radius: 4px;
            line-height: 1.6;
        }

        .privacy-section li::before {
            content: 'âœ“ ';
            color: var(--success-color);
            font-weight: bold;
            margin-right: 8px;
        }

        .privacy-highlight {
            background: rgba(255, 0, 0, 0.1);
            border-left: 4px solid var(--primary-color);
            padding: 15px;
            border-radius: 6px;
            margin: 20px 0;
            color: var(--text-primary);
        }

        .privacy-highlight strong {
            color: var(--primary-color);
        }

        .privacy-link {
            color: var(--verified-color);
            text-decoration: none;
            transition: color 0.3s;
        }

        .privacy-link:hover {
            color: var(--primary-color);
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .library-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 15px;
            }

            .video-header {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }

            .video-header h1 {
                font-size: 1.2rem;
            }

            .video-title {
                font-size: 1.1rem;
            }

            .comments-header h2 {
                font-size: 1.2rem;
            }

            .comment-form {
                padding: 15px;
            }

            .dub-buttons {
                flex-direction: column;
            }

            .dub-btn {
                width: 100%;
                justify-content: center;
            }

            .video-controls {
                width: 100%;
                justify-content: flex-start;
            }

            .control-panel {
                flex-direction: column;
                gap: 12px;
            }

            .control-buttons {
                width: 100%;
                justify-content: center;
                gap: 10px;
            }

            .control-btn {
                width: 50px;
                height: 50px;
                font-size: 18px;
            }

            .control-btn-small {
                width: 40px;
                height: 40px;
                font-size: 14px;
            }

            .privacy-header {
                padding: 20px;
            }

            .privacy-header h1 {
                font-size: 1.5rem;
            }

            .privacy-content {
                padding: 20px;
            }

            .privacy-section h2 {
                font-size: 1.2rem;
            }

            .privacy-section li {
                padding: 8px 12px;
            }
        }
    </style>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9RXK5ZKJD6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9RXK5ZKJD6');
</script>
</head>
<body>
    <div class="container">

        <!-- Breadcrumb -->
        <div class="breadcrumb" id="breadcrumb">
            <button
                class="back-btn"
                id="backBtn"
                data-i18n="back"
                onclick="App.goHome()"
                style="display: none;">
            </button>
            <span id="breadcrumbText" data-i18n="library"></span>
        </div>

        <!-- Library View -->
        <div id="libraryView" class="library-view">
            <div class="library-header">
                <h1 id="libraryTitle" data-i18n="library"></h1>
            </div>
            <div class="library-grid" id="libraryGrid"></div>
        </div>

        <!-- Privacy Policy View -->
        <div id="privacyView" class="privacy-view hidden">
            <div class="privacy-header">
                <h1 id="privacyTitle" data-i18n="privacyTitle"></h1>
                <div class="last-updated" id="privacyDate" data-i18n="privacyLastUpdate"></div>
            </div>
            <div class="privacy-content">
                <div id="privacyContent"></div>
            </div>
        </div>

        <!-- Video View -->
        <div id="videoView" class="hidden">
            <div class="video-section">

                <div class="video-header">
                    <h1>
                        <span id="appTitle" data-i18n="appTitle"></span>
                        <div id="dubLongPressHint" data-i18n="dubLongPressHint"
                             style="font-size:12px;color:#aaa;margin-top:4px;">
                        </div>
                    </h1>

                    <div class="video-controls">
                        <div class="quick-toggle">
                            <button
                                id="dubToggle"
                                class="sys-toggle"
                                data-i18n-title="dubTitle">
                                <span class="icon">X</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="video-container" id="videoContainer"></div>

                <div class="control-panel" id="controlPanel">
                    <div id="preDubNotice" class="dub-notice" data-i18n="preDubNotice"></div>

                    <div id="dubControls" class="control-buttons hidden">
                        <!-- Backward Controls -->
                        <div class="control-btn-group">
                            <button class="control-btn control-btn-small" onclick="DubEngine.adjustTime(-1.5)" aria-label="backward 1.5s">
                                &lt;
                            </button>
                            <span class="btn-label">1.5s</span>
                        </div>

                        <div class="control-btn-group">
                            <button class="control-btn" onclick="DubEngine.adjustTime(-1)" aria-label="backward 1s">
                                &lt;
                            </button>
                            <span class="btn-label">1s</span>
                        </div>

                        <!-- Forward Controls -->
                        <div class="control-btn-group">
                            <button class="control-btn" onclick="DubEngine.adjustTime(1)" aria-label="forward 1s">
                                &gt;
                            </button>
                            <span class="btn-label">1s</span>
                        </div>

                        <div class="control-btn-group">
                            <button class="control-btn control-btn-small" onclick="DubEngine.adjustTime(1.5)" aria-label="forward 1.5s">
                                &gt;
                            </button>
                            <span class="btn-label">1.5s</span>
                        </div>
                    </div>
                </div>

                <div class="dub-selector" id="dubSelector" style="display: none;">
                    <h3 id="dubTitle" data-i18n="dubTitle"></h3>
                    <div class="dub-buttons" id="dubButtons"></div>

                    <div class="dub-status-indicator" id="dubStatusIndicator">
                        <span id="statusText"></span>
                    </div>
                </div>

                <div class="video-info">
                    <h2 class="video-title" id="videoTitle"></h2>
                    <p class="video-description" id="videoDescription"></p>
                </div>
            </div>

            <!-- Comments -->
            <div class="comments-section">
                <div class="comments-header">
                    <h2>
                        <span class="comments-update-indicator paused" id="updateIndicator"></span>
                        <span id="commentsTitle" data-i18n="comments"></span>
                    </h2>
                    <span
                        class="comments-count"
                        id="commentsCount"
                        data-i18n="commentCount"
                        data-i18n-count="0">
                    </span>
                </div>

                <div class="status-message" id="statusMessage"></div>

                <div class="comment-form">
                    <form id="commentForm">
                        <div class="form-group">
                            <label for="commentName" id="labelName" data-i18n="labelName"></label>
                            <input
                                type="text"
                                id="commentName"
                                maxlength="50"
                                data-i18n-placeholder="placeholderName">
                            <div class="form-hint" id="hintName" data-i18n="hintName"></div>
                        </div>

                        <div class="form-group">
                            <label for="commentText" id="labelComment" data-i18n="labelComment"></label>
                            <textarea
                                id="commentText"
                                required
                                maxlength="500"
                                data-i18n-placeholder="placeholderComment">
                            </textarea>
                        </div>

                        <button
                            type="submit"
                            class="submit-btn"
                            id="submitBtn"
                            data-i18n="submit">
                        </button>
                    </form>
                </div>

                <div id="commentsListContainer">
                    <div class="loading" id="loadingText" data-i18n="loading"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Language Switch -->
    <div id="langToggle" data-i18n-title="langButtonLabel">ğŸŒ</div>

    <div id="langMenu" class="hidden">
        <button data-lang="ar" data-i18n="langAr"></button>
        <button data-lang="en" data-i18n="langEn"></button>
        <button data-lang="fr" data-i18n="langFr"></button>
        <button data-lang="ja" data-i18n="langJa"></button>
        <button onclick="App.viewPrivacy()" style="border-top: 1px solid var(--border-color);" data-i18n="privacyMenu"></button>
    </div>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/i18next/23.7.6/i18next.min.js"></script>
    
    <script>
// ============================================
// GLOBAL STATE & CONFIGURATION
// ============================================
const CONFIG = {
    BACKEND_URL: 'https://site--watch-vip--j9hb6dlmp4qm.code.run',
    REFRESH_INTERVAL: 10000,
    SUBMIT_COOLDOWN: 3000,
    LONG_PRESS_DURATION: 500,
    SEEK_STEP: 1
};

// YouTube API
let YTReady = false;
window.onYouTubeIframeAPIReady = function() {
    YTReady = true;
    console.log('YouTube API Ready');
    DubEngine.setupPlayersWhenReady();
};

// ============================================
// i18next CONFIGURATION
// ============================================
const i18nResources = {
    ar: {
        translation: {
            library: 'Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª',
            back: 'Ø§Ù„Ø±Ø¬ÙˆØ¹',
            comments: 'Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª',
            commentCount: '{{count}} ØªØ¹Ù„ÙŠÙ‚',
            commentCount_plural: '{{count}} ØªØ¹Ù„ÙŠÙ‚',
            labelName: 'Ø§Ù„Ø§Ø³Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)',
            hintName: 'Ø³ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ø³Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¥Ù† Ù„Ù… ØªÙƒØªØ¨',
            labelComment: 'Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ *',
            placeholderName: 'Ø§ØªØ±Ùƒ ÙØ§Ø±ØºØ§Ù‹ Ù„Ù„ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ',
            placeholderComment: 'Ø´Ø§Ø±Ùƒ Ø±Ø£ÙŠÙƒ...',
            submit: 'Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚',
            submitting: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„',
            noComments: 'Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†',
            loading: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„',
            pending: 'Ù„Ø¯ÙŠÙƒ ØªØ¹Ù„ÙŠÙ‚ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',
            empty: 'Ø£ÙƒÙ…Ù„ ÙƒØªØ§Ø¨Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚',
            success: 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ø¨Ù†Ø¬Ø§Ø­',
            error: 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„',
            canComment: 'ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ù…Ø¬Ø¯Ø¯Ø§Ù‹',
            rateLimitError: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„',
            langButtonLabel: 'ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©',
            dubTitle: 'Ø§Ø®ØªØ± Ù†Ø³Ø®Ø© Ø§Ù„Ø¹Ø±Ø¶',
            dubHint: 'Ø§Ù†Ù‚Ø± Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ØŒ Ø§Ø¶ØºØ· Ø·ÙˆÙŠÙ„Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©',
            episodeCount: '{{count}} Ø­Ù„Ù‚Ø©',
            episodeCount_plural: '{{count}} Ø­Ù„Ù‚Ø©',
            statusOriginal: 'Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ù‚ÙŠØ¯ Ø§Ù„ØªØ´ØºÙŠÙ„',
            statusArabic: 'Ø§Ù„Ø¯Ø¨Ù„Ø¬Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù…ÙØ¹Ù„Ø©',
            statusJapanese: 'Ø§Ù„Ø¯Ø¨Ù„Ø¬Ø© Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ÙŠØ© Ù…ÙØ¹Ù„Ø©',
            appTitle: 'Watch VIP',
            dubLongPressHint: 'Ø§Ø¶ØºØ· Ù…Ø·ÙˆÙ‘Ù„Ù‹Ø§ Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¯Ø¨Ù„Ø¬Ø© Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¯Ø¨Ù„Ø¬Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©',
            preDubNotice: 'Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ù„Ø¶Ø¨Ø· Ø§Ù„ØªÙˆÙ‚ÙŠØª ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø©',
            justNow: 'Ù„Ù„ØªÙˆ',
            minutesAgo: 'Ù…Ù†Ø° {{count}} Ø¯Ù‚ÙŠÙ‚Ø©',
            hoursAgo: 'Ù…Ù†Ø° {{count}} Ø³Ø§Ø¹Ø©',
            daysAgo: 'Ù…Ù†Ø° {{count}} ÙŠÙˆÙ…',
            original: 'Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©',
            metaDescription: 'Ø¯Ø§Ø±Ù†Ø§ Ù„Ø¥Ø®ØªÙŠØ§Ø± Ù…Ù‚Ø¹Ø¯Ùƒ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨',
            arabicDub: 'Ø¯Ø¨Ù„Ø¬Ø© Ø¹Ø±Ø¨ÙŠØ©',
            japaneseDub: 'Ø¯Ø¨Ù„Ø¬Ø© ÙŠØ§Ø¨Ø§Ù†ÙŠØ©',
            langAr: 'Ø¹Ø±Ø¨ÙŠ',
            langEn: 'English',
            langFr: 'FranÃ§ais',
            langJa: 'æ—¥æœ¬èª',
            privacyTitle: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©',
            privacyLastUpdate: 'Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: 15 Ø¬Ø§Ù†ÙÙŠ 2026',
            privacyMenu: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©',
            'series.doraemon.title': 'Ø¯ÙˆØ±Ø§ÙŠÙ…ÙˆÙ†',
            'series.doraemon.episode.ep01.title': 'Ø§Ù„Ø­Ù„Ù‚Ø© 01 - Ø¨Ø¯Ø§ÙŠØ© Ø¯ÙˆØ±Ø§ÙŠÙ…ÙˆÙ†',
            'series.doraemon.episode.ep01.description': 'Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø£Ø­Ù„Ø§Ù… â€“ Ø£Ø±Ø¶ Ù†ÙˆØ¨ÙŠØªØ§'
        }
    },
    en: {
        translation: {
            library: 'Series',
            back: 'Back',
            comments: 'Comments',
            commentCount: '{{count}} comment',
            commentCount_plural: '{{count}} comments',
            labelName: 'Name (Optional)',
            hintName: 'An automatic name will be generated if left blank',
            labelComment: 'Comment *',
            placeholderName: 'Leave blank for auto-generation',
            placeholderComment: 'Share your thoughts...',
            submit: 'Post Comment',
            submitting: 'Posting',
            noComments: 'No comments yet',
            loading: 'Loading',
            pending: 'Your comment is under review',
            empty: 'Please write a comment',
            success: 'Comment posted successfully',
            error: 'Failed to send comment',
            canComment: 'You can comment again',
            rateLimitError: 'Please wait a moment before posting',
            langButtonLabel: 'Change Language',
            dubTitle: 'Choose Version',
            dubHint: 'Click to toggle, long press to show menu',
            episodeCount: '{{count}} episode',
            episodeCount_plural: '{{count}} episodes',
            statusOriginal: 'Original version is playing',
            statusArabic: 'Arabic dub is enabled',
            statusJapanese: 'Japanese dub is enabled',
            appTitle: 'Watch VIP',
            dubLongPressHint: 'Long press the dub button to select the appropriate dubbing',
            preDubNotice: 'Use the control buttons to manually adjust timing as needed',
            justNow: 'just now',
            minutesAgo: '{{count}}m ago',
            hoursAgo: '{{count}}h ago',
            daysAgo: '{{count}}d ago',
            original: 'Original Version',
            metaDescription: 'Our home for choosing the right seat',
            arabicDub: 'Arabic Dub',
            japaneseDub: 'Japanese Dub',
            langAr: 'Ø¹Ø±Ø¨ÙŠ',
            langEn: 'English',
            langFr: 'FranÃ§ais',
            langJa: 'æ—¥æœ¬èª',
            privacyTitle: 'Privacy Policy',
            privacyLastUpdate: 'Last Updated: January 15, 2026',
            privacyMenu: 'Privacy Policy',
            'series.doraemon.title': 'Doraemon',
            'series.doraemon.episode.ep01.title': 'Episode 01 - The Beginning of Doraemon',
            'series.doraemon.episode.ep01.description': 'Dream City - Nobita\'s Land'
        }
    },
    fr: {
        translation: {
            library: 'SÃ©ries',
            back: 'Retour',
            comments: 'Commentaires',
            commentCount: '{{count}} commentaire',
            commentCount_plural: '{{count}} commentaires',
            labelName: 'Nom (Optionnel)',
            hintName: 'Un nom automatique sera gÃ©nÃ©rÃ© si laissÃ© vide',
            labelComment: 'Commentaire *',
            placeholderName: 'Laisser vide pour la gÃ©nÃ©ration automatique',
            placeholderComment: 'Partagez vos pensÃ©es...',
            submit: 'Publier le commentaire',
            submitting: 'Publication',
            noComments: 'Pas encore de commentaires',
            loading: 'Chargement',
            pending: 'Votre commentaire est en attente d\'approbation',
            empty: 'Veuillez Ã©crire un commentaire',
            success: 'Commentaire publiÃ© avec succÃ¨s',
            error: 'Erreur lors de l\'envoi',
            canComment: 'Vous pouvez commenter Ã  nouveau',
            rateLimitError: 'Veuillez attendre un moment avant de publier',
            langButtonLabel: 'Changer la Langue',
            dubTitle: 'Choisir la version',
            dubHint: 'Cliquez pour basculer, appuyez longuement pour le menu',
            episodeCount: '{{count}} Ã©pisode',
            episodeCount_plural: '{{count}} Ã©pisodes',
            statusOriginal: 'La version originale est en cours de lecture',
            statusArabic: 'Le doublage arabe est activÃ©',
            statusJapanese: 'Le doublage japonais est activÃ©',
            appTitle: 'Watch VIP',
            dubLongPressHint: 'Appuyez longuement sur le bouton de doublage pour sÃ©lectionner le doublage appropriÃ©',
            preDubNotice: 'Utilisez les boutons de contrÃ´le pour ajuster manuellement le timing selon les besoins',
            justNow: 'Ã  l\'instant',
            minutesAgo: 'il y a {{count}}m',
            hoursAgo: 'il y a {{count}}h',
            daysAgo: 'il y a {{count}}j',
            original: 'Version Originale',
            metaDescription: 'Notre site pour choisir le siÃ¨ge idÃ©al',
            arabicDub: 'Doublage Arabe',
            japaneseDub: 'Doublage Japonais',
            langAr: 'Ø¹Ø±Ø¨ÙŠ',
            langEn: 'English',
            langFr: 'FranÃ§ais',
            langJa: 'æ—¥æœ¬èª',
            privacyTitle: 'Politique de ConfidentialitÃ©',
            privacyLastUpdate: 'DerniÃ¨re mise Ã  jour: 15 janvier 2026',
            privacyMenu: 'Politique de ConfidentialitÃ©',
            'series.doraemon.title': 'Doraemon',
            'series.doraemon.episode.ep01.title': 'Ã‰pisode 01 - Le DÃ©but de Doraemon',
            'series.doraemon.episode.ep01.description': 'Ville des RÃªves - Terre de Nobita'
        }
    },
    ja: {
        translation: {
            library: 'ã‚·ãƒªãƒ¼ã‚º',
            back: 'æˆ»ã‚‹',
            comments: 'ã‚³ãƒ¡ãƒ³ãƒˆ',
            commentCount: '{{count}}ã‚³ãƒ¡ãƒ³ãƒˆ',
            commentCount_plural: '{{count}}ã‚³ãƒ¡ãƒ³ãƒˆ',
            labelName: 'åå‰ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)',
            hintName: 'ç©ºç™½ã®ã¾ã¾ã«ã™ã‚‹ã¨ãƒ©ãƒ³ãƒ€ãƒ ã«ç”Ÿæˆã•ã‚Œã¾ã™',
            labelComment: 'ã‚³ãƒ¡ãƒ³ãƒˆ *',
            placeholderName: 'è‡ªå‹•ç”Ÿæˆã®ãŸã‚ç©ºç™½ã®ã¾ã¾ã«ã—ã¦ãã ã•ã„',
            placeholderComment: 'ã‚ãªãŸã®è€ƒãˆã‚’å…±æœ‰ã—ã¦ãã ã•ã„...',
            submit: 'ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿',
            submitting: 'æŠ•ç¨¿ä¸­',
            noComments: 'ã¾ã ã‚³ãƒ¡ãƒ³ãƒˆãŒã‚ã‚Šã¾ã›ã‚“',
            loading: 'èª­ã¿è¾¼ã¿ä¸­',
            pending: 'ã‚³ãƒ¡ãƒ³ãƒˆã¯å¯©æŸ»ä¸­ã§ã™',
            empty: 'ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
            success: 'ã‚³ãƒ¡ãƒ³ãƒˆãŒæ­£å¸¸ã«æŠ•ç¨¿ã•ã‚Œã¾ã—ãŸ',
            error: 'é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ',
            canComment: 'ã‚‚ã†ä¸€åº¦ã‚³ãƒ¡ãƒ³ãƒˆã§ãã¾ã™',
            rateLimitError: 'æŠ•ç¨¿ã™ã‚‹å‰ã«ãŠå¾…ã¡ãã ã•ã„',
            langButtonLabel: 'è¨€èªã‚’å¤‰æ›´',
            dubTitle: 'ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’é¸æŠ',
            dubHint: 'ã‚¯ãƒªãƒƒã‚¯ã—ã¦åˆ‡ã‚Šæ›¿ãˆã€é•·æŠ¼ã—ã—ã¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¡¨ç¤º',
            episodeCount: '{{count}}ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰',
            episodeCount_plural: '{{count}}ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰',
            statusOriginal: 'ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå†ç”Ÿä¸­',
            statusArabic: 'ã‚¢ãƒ©ãƒ“ã‚¢èªå¹ãæ›¿ãˆãŒæœ‰åŠ¹',
            statusJapanese: 'æ—¥æœ¬èªå¹ãæ›¿ãˆãŒæœ‰åŠ¹',
            appTitle: 'Watch VIP',
            dubLongPressHint: 'å¹ãæ›¿ãˆãƒœã‚¿ãƒ³ã‚’é•·æŠ¼ã—ã—ã¦é©åˆ‡ãªå¹ãæ›¿ãˆã‚’é¸æŠã—ã¦ãã ã•ã„',
            preDubNotice: 'å¿…è¦ã«å¿œã˜ã¦ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦æ‰‹å‹•ã§ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’èª¿æ•´ã—ã¦ãã ã•ã„',
            justNow: 'ä»Š',
            minutesAgo: '{{count}}åˆ†å‰',
            hoursAgo: '{{count}}æ™‚é–“å‰',
            daysAgo: '{{count}}æ—¥å‰',
            original: 'ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³',
            metaDescription: 'é©åˆ‡ãªåº§å¸­ã‚’é¸ã¶ãŸã‚ã®ãƒ›ãƒ¼ãƒ ',
            arabicDub: 'ã‚¢ãƒ©ãƒ“ã‚¢èªå¹ãæ›¿ãˆ',
            japaneseDub: 'æ—¥æœ¬èªå¹ãæ›¿ãˆ',
            langAr: 'Ø¹Ø±Ø¨ÙŠ',
            langEn: 'English',
            langFr: 'FranÃ§ais',
            langJa: 'æ—¥æœ¬èª',
            privacyTitle: 'ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼',
            privacyLastUpdate: 'æœ€çµ‚æ›´æ–°: 2026å¹´1æœˆ15æ—¥',
            privacyMenu: 'ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼',
            'series.doraemon.title': 'ãƒ‰ãƒ©ãˆã‚‚ã‚“',
            'series.doraemon.episode.ep01.title': 'ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰01 - ãƒ‰ãƒ©ãˆã‚‚ã‚“ã®å§‹ã¾ã‚Š',
            'series.doraemon.episode.ep01.description': 'ãƒ‰ãƒªãƒ¼ãƒ ã‚·ãƒ†ã‚£ - ã®ã³å¤ªã®å›½'
        }
    }
};

// Privacy Policy Content
const PRIVACY_CONTENT = {
    ar: [
        {
            title: '1. Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙŠ Ù†Ù‚ÙˆÙ… Ø¨Ø¬Ù…Ø¹Ù‡Ø§',
            items: [
                'Ù†ÙˆØ¹ Ø§Ù„Ù…ØªØµÙØ­ ÙˆØ¥ØµØ¯Ø§Ø±Ù‡',
                'Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
                'Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„ØªÙŠ ÙŠØªÙ… ØªØµÙØ­Ù‡Ø§ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹',
                'Ù…Ø¯Ø© Ø§Ù„Ø²ÙŠØ§Ø±Ø© ÙˆÙ…ØµØ¯Ø± Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹'
            ],
            description: 'ØªÙØ³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù„Ø£ØºØ±Ø§Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ© ÙÙ‚Ø·ØŒ ÙˆØªØ­Ø³ÙŠÙ† Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŒ ÙˆÙ„Ø§ ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ Ù„Ù„ØªØ¹Ø±Ù‘Ù Ø¹Ù„Ù‰ Ù‡ÙˆÙŠØ© Ø§Ù„Ø²Ø§Ø¦Ø± Ø§Ù„Ø´Ø®ØµÙŠØ©.'
        },
        {
            title: '2. Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· (Cookies)',
            items: [
                'ØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ø§Ù…Ø©',
                'Ø­ÙØ¸ ØªÙØ¶ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ù…Ø«Ù„ Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©)',
                'ØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª',
                'Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ù†Ø§Ø³Ø¨Ø© ÙˆØ´Ø®ØµÙŠØ©'
            ],
            description: 'ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… ØªØ¹Ø·ÙŠÙ„ Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ù…Ù† Ø®Ù„Ø§Ù„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØµÙØ­ Ø§Ù„Ø®Ø§Øµ Ø¨Ù‡ØŒ Ù…Ø¹ Ø§Ù„Ø¹Ù„Ù… Ø£Ù† Ø¨Ø¹Ø¶ Ø®ØµØ§Ø¦Øµ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù‚Ø¯ Ù„Ø§ ØªØ¹Ù…Ù„ Ø¨Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„Ø£Ù…Ø«Ù„ Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ.'
        },
        {
            title: '3. Google AdSense ÙˆØ§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª',
            description: 'ÙŠØ³ØªØ®Ø¯Ù… Ù…ÙˆÙ‚Ø¹ darnafull.com Ø®Ø¯Ù…Ø© Google AdSense Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª. ØªÙ‚ÙˆÙ… Google Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· (Ù…Ø«Ù„ Ù…Ù„Ù DART cookie) Ù„Ø¹Ø±Ø¶ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØªØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù‡ØªÙ…Ø§Ù…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…. ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ØªØ¹Ø·ÙŠÙ„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù„Ù ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· DART Ù…Ù† Ø®Ù„Ø§Ù„ Ø²ÙŠØ§Ø±Ø© <a href="https://policies.google.com/technologies/ads" class="privacy-link">ØµÙØ­Ø© Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Google</a>'
        },
        {
            title: '4. Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ù† YouTube',
            description: 'ÙŠØ¹ØªÙ…Ø¯ Ù…ÙˆÙ‚Ø¹ darnafull.com Ø¹Ù„Ù‰ ØªØ¶Ù…ÙŠÙ† Ù…Ù‚Ø§Ø·Ø¹ ÙÙŠØ¯ÙŠÙˆ Ù…Ù† Ù…Ù†ØµØ© YouTube Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø´ØºÙ„ Ø§Ù„Ø±Ø³Ù…ÙŠ (iframe)ØŒ ÙˆÙ„Ø§ ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø§Ø³ØªØ¶Ø§ÙØ© Ø£Ùˆ Ø¥Ø¹Ø§Ø¯Ø© Ø±ÙØ¹ Ø£ÙŠ Ù…Ø­ØªÙˆÙ‰ Ù…Ø±Ø¦ÙŠ Ø¹Ù„Ù‰ Ø®ÙˆØ§Ø¯Ù…Ù‡ Ø§Ù„Ø®Ø§ØµØ©. Ø¬Ù…ÙŠØ¹ Ø­Ù‚ÙˆÙ‚ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª ØªØ¹ÙˆØ¯ Ù„Ø£ØµØ­Ø§Ø¨Ù‡Ø§ Ø§Ù„Ø£ØµÙ„ÙŠÙŠÙ† ÙˆÙ…Ù†ØµØ© YouTubeØŒ ÙˆÙŠØ®Ø¶Ø¹ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‚Ø§Ø·Ø¹ Ù„Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ© ÙˆØ´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù€ YouTube.'
        },
        {
            title: '5. Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª ÙˆØ§Ù„ØªÙØ§Ø¹Ù„',
            items: [
                'Ù‚Ø¯ ÙŠØªÙ… ØªØ®Ø²ÙŠÙ† Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ ÙˆÙˆÙ‚Øª Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„Ø¹Ø±Ø¶ ÙˆØ§Ù„ØªÙ†Ø¸ÙŠÙ…',
                'Ù„Ø§ Ù†Ø·Ù„Ø¨ Ø£ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø´Ø®ØµÙŠØ© Ø­Ø³Ø§Ø³Ø© Ø£Ùˆ Ø®Ø·Ø±Ø©',
                'Ø§Ù„Ù‡Ø¯Ù Ù…Ù† Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ù‡Ùˆ Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ ÙˆØ£Ø±Ø´ÙØ© Ø§Ù„Ø¢Ø±Ø§Ø¡ ÙÙ‚Ø·',
                'Ù†Ø­ØªÙØ¸ Ø¨Ø§Ù„Ø­Ù‚ ÙÙŠ Ø­Ø°Ù Ø£ÙŠ ØªØ¹Ù„ÙŠÙ‚ Ù…Ø®Ø§Ù„Ù Ù„Ù„Ø£Ø¯Ø¨ Ø§Ù„Ø¹Ø§Ù…'
            ]
        },
        {
            title: '6. Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ø·ÙØ§Ù„',
            description: 'ÙŠÙ‡Ø¯Ù Ù…ÙˆÙ‚Ø¹ darnafull.com Ø¥Ù„Ù‰ ØªÙ‚Ø¯ÙŠÙ… Ù…Ø­ØªÙˆÙ‰ ØªØ±ÙÙŠÙ‡ÙŠ Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©ØŒ ÙŠØ±ÙƒÙ‘Ø² Ø¹Ù„Ù‰ Ø¥Ø­ÙŠØ§Ø¡ Ø°ÙƒØ±ÙŠØ§Øª Ø§Ù„Ø·ÙÙˆÙ„Ø© Ø¨Ø·Ø±ÙŠÙ‚Ø© Ù…Ø­ØªØ±Ù…Ø© ÙˆØ¢Ù…Ù†Ø©ØŒ ÙˆÙ„Ø§ ÙŠØ³ØªÙ‡Ø¯Ù Ø¬Ù…Ø¹ Ø£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø´Ø®ØµÙŠØ© Ù…Ù† Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø¨Ø´ÙƒÙ„ Ù…ØªØ¹Ù…Ù‘Ø¯.'
        },
        {
            title: '7. Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©',
            description: 'Ù‚Ø¯ ÙŠØ­ØªÙˆÙŠ Ù…ÙˆÙ‚Ø¹ darnafull.com Ø¹Ù„Ù‰ Ø±ÙˆØ§Ø¨Ø· Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø®Ø§Ø±Ø¬ÙŠØ© (Ù…Ø«Ù„ YouTube). Ù†Ø­Ù† ØºÙŠØ± Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† Ø¹Ù† Ù…Ø­ØªÙˆÙ‰ Ø£Ùˆ Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø®ØµÙˆØµÙŠØ© Ø§Ù„Ø®Ø§ØµØ© Ø¨ØªÙ„Ùƒ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ØŒ ÙˆÙ†Ù†ØµØ­ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¨Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø®ØµÙˆØµÙŠØ© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡Ø§.'
        },
        {
            title: '8. Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©',
            description: 'Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…Ùƒ Ù„Ù…ÙˆÙ‚Ø¹ darnafull.comØŒ ÙØ¥Ù†Ùƒ ØªÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ© Ù‡Ø°Ù‡ ÙˆØªÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø¨Ù†ÙˆØ¯Ù‡Ø§.'
        },
        {
            title: '9. Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¹Ù„Ù‰ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©',
            description: 'Ù†Ø­ØªÙØ¸ Ø¨Ø§Ù„Ø­Ù‚ ÙÙŠ ØªØ¹Ø¯ÙŠÙ„ Ø£Ùˆ ØªØ­Ø¯ÙŠØ« Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ© Ù‡Ø°Ù‡ ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª. Ø³ÙŠØªÙ… Ù†Ø´Ø± Ø£ÙŠ ØªØ¹Ø¯ÙŠÙ„ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ù…Ø¹ ØªØ­Ø¯ÙŠØ« ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©.'
        }
    ],
    en: [
        {
            title: '1. Information We Collect',
            items: [
                'Browser type and version',
                'Operating system',
                'Pages browsed on the website',
                'Visit duration and referral source'
            ],
            description: 'This information is used for statistical purposes only and to improve website performance and user experience. It is not used to identify visitors personally.'
        },
        {
            title: '2. Cookies (Website Tracking Files)',
            items: [
                'Improve overall user experience',
                'Save user preferences (such as selected language)',
                'Analyze website performance and statistics',
                'Display appropriate and personalized advertisements'
            ],
            description: 'Users can disable cookies through their browser settings, although some website features may not work optimally afterward.'
        },
        {
            title: '3. Google AdSense and Advertisements',
            description: 'The website darnafull.com uses Google AdSense to display advertisements. Google uses cookies (such as DART cookie) to show advertisements tailored to user interests. Users can disable the DART cookie through <a href="https://policies.google.com/technologies/ads" class="privacy-link">Google\'s advertising privacy policy page</a>'
        },
        {
            title: '4. YouTube Video Content',
            description: 'The website darnafull.com embeds videos from YouTube using the official player (iframe) and does not host or upload any content on its own servers. All video rights belong to their original owners and YouTube. Use of these videos is subject to YouTube\'s privacy policy and terms of service.'
        },
        {
            title: '5. Comments and Interaction',
            items: [
                'Comment content and submission time may be stored for display and organization',
                'We do not request any sensitive or dangerous personal information',
                'Comments are for positive interaction and opinion archiving only',
                'We reserve the right to delete any comments violating community standards'
            ]
        },
        {
            title: '6. Child Protection',
            description: 'The website darnafull.com aims to provide family-friendly entertainment content, focusing on reviving childhood memories in a respectful and safe manner. We do not intentionally collect personal data from children.'
        },
        {
            title: '7. External Links',
            description: 'The website darnafull.com may contain links to external sites (such as YouTube). We are not responsible for the content or privacy policies of these sites. We recommend users review their privacy policies.'
        },
        {
            title: '8. Consent to Privacy Policy',
            description: 'By using darnafull.com, you agree to this privacy policy and all its terms.'
        },
        {
            title: '9. Changes to Privacy Policy',
            description: 'We reserve the right to modify or update this privacy policy at any time. Any changes will be posted on this page with an updated revision date.'
        }
    ],
    fr: [
        {
            title: '1. Informations que nous collectons',
            items: [
                'Type et version du navigateur',
                'SystÃ¨me d\'exploitation utilisÃ©',
                'Pages consultÃ©es sur le site',
                'DurÃ©e de la visite et source de rÃ©fÃ©rence'
            ],
            description: 'Ces informations sont utilisÃ©es Ã  des fins statistiques uniquement et pour amÃ©liorer les performances du site et l\'expÃ©rience utilisateur. Elles ne sont pas utilisÃ©es pour identifier les visiteurs personnellement.'
        },
        {
            title: '2. Cookies (Fichiers de suivi du site)',
            items: [
                'AmÃ©liorer l\'expÃ©rience utilisateur globale',
                'Enregistrer les prÃ©fÃ©rences utilisateur (comme la langue sÃ©lectionnÃ©e)',
                'Analyser les performances du site et les statistiques',
                'Afficher des publicitÃ©s appropriÃ©es et personnalisÃ©es'
            ],
            description: 'Les utilisateurs peuvent dÃ©sactiver les cookies via les paramÃ¨tres de leur navigateur, bien que certaines fonctionnalitÃ©s du site pourraient ne pas fonctionner correctement.'
        },
        {
            title: '3. Google AdSense et PublicitÃ©s',
            description: 'Le site darnafull.com utilise Google AdSense pour afficher des publicitÃ©s. Google utilise des cookies (comme le cookie DART) pour afficher des publicitÃ©s adaptÃ©es aux intÃ©rÃªts de l\'utilisateur. Les utilisateurs peuvent dÃ©sactiver le cookie DART via <a href="https://policies.google.com/technologies/ads" class="privacy-link">la page de politique de confidentialitÃ© des publicitÃ©s Google</a>'
        },
        {
            title: '4. Contenu vidÃ©o YouTube',
            description: 'Le site darnafull.com intÃ¨gre des vidÃ©os de YouTube en utilisant le lecteur officiel (iframe) et n\'hÃ©berge pas de contenu sur ses propres serveurs. Tous les droits des vidÃ©os appartiennent Ã  leurs propriÃ©taires d\'origine et Ã  YouTube. L\'utilisation de ces vidÃ©os est soumise Ã  la politique de confidentialitÃ© et aux conditions d\'utilisation de YouTube.'
        },
        {
            title: '5. Commentaires et Interactions',
            items: [
                'Le contenu des commentaires et l\'heure d\'envoi peuvent Ãªtre stockÃ©s Ã  des fins d\'affichage et d\'organisation',
                'Nous ne demandons aucune information personnelle sensible ou dangereuse',
                'Les commentaires sont destinÃ©s Ã  l\'interaction positive et Ã  l\'archivage des opinions',
                'Nous nous rÃ©servons le droit de supprimer tout commentaire violant les normes communautaires'
            ]
        },
        {
            title: '6. Protection des Enfants',
            description: 'Le site darnafull.com vise Ã  fournir un contenu divertissant adaptÃ© aux familles, en mettant l\'accent sur la revitalisation des souvenirs d\'enfance de maniÃ¨re respectueuse et sÃ»re. Nous ne collectons pas intentionnellement de donnÃ©es personnelles auprÃ¨s des enfants.'
        },
        {
            title: '7. Liens Externes',
            description: 'Le site darnafull.com peut contenir des liens vers des sites externes (comme YouTube). Nous ne sommes pas responsables du contenu ou des politiques de confidentialitÃ© de ces sites. Nous recommandons aux utilisateurs de consulter leurs politiques de confidentialitÃ©.'
        },
        {
            title: '8. Consentement Ã  la Politique de ConfidentialitÃ©',
            description: 'En utilisant darnafull.com, vous acceptez cette politique de confidentialitÃ© et tous ses termes.'
        },
        {
            title: '9. Modifications de la Politique de ConfidentialitÃ©',
            description: 'Nous nous rÃ©servons le droit de modifier ou de mettre Ã  jour cette politique de confidentialitÃ© Ã  tout moment. Tout changement sera affichÃ© sur cette page avec une date de rÃ©vision mise Ã  jour.'
        }
    ],
    ja: [
        {
            title: '1. åé›†ã™ã‚‹æƒ…å ±',
            items: [
                'ãƒ–ãƒ©ã‚¦ã‚¶ã®ç¨®é¡ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³',
                'ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ',
                'ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆå†…ã§é–²è¦§ã•ã‚Œã‚‹ãƒšãƒ¼ã‚¸',
                'è¨ªå•æœŸé–“ã¨ãƒªãƒ•ã‚¡ãƒ©ãƒ«æƒ…å ±'
            ],
            description: 'ã“ã®æƒ…å ±ã¯çµ±è¨ˆç›®çš„ã®ã¿ã«ä½¿ç”¨ã•ã‚Œã€ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚’æ”¹å–„ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚è¨ªå•è€…ã‚’å€‹äººçš„ã«ç‰¹å®šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚'
        },
        {
            title: '2. Cookieï¼ˆã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆè¿½è·¡ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰',
            items: [
                'ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“å…¨èˆ¬ã®æ”¹å–„',
                'ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šã®ä¿å­˜ï¼ˆé¸æŠã•ã‚ŒãŸè¨€èªãªã©ï¼‰',
                'ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨çµ±è¨ˆã®åˆ†æ',
                'é©åˆ‡ã§ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸåºƒå‘Šã®è¡¨ç¤º'
            ],
            description: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ–ãƒ©ã‚¦ã‚¶è¨­å®šã‹ã‚‰Cookieã‚’ç„¡åŠ¹ã«ã§ãã¾ã™ãŒã€ãã®å¾Œã€ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®ã„ãã¤ã‹ã®æ©Ÿèƒ½ãŒæœ€é©ã«æ©Ÿèƒ½ã—ãªã„ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚'
        },
        {
            title: '3. Google AdSenseã¨åºƒå‘Š',
            description: 'ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆdarnafull.comã¯Google AdSenseã‚’ä½¿ç”¨ã—ã¦åºƒå‘Šã‚’è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚Googleã¯ã‚¯ãƒƒã‚­ãƒ¼ï¼ˆDARTã‚¯ãƒƒã‚­ãƒ¼ãªã©ï¼‰ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®èˆˆå‘³ã«åˆã‚ã›ãŸåºƒå‘Šã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯<a href="https://policies.google.com/technologies/ads" class="privacy-link">Googleã®åºƒå‘Šãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ãƒšãƒ¼ã‚¸</a>ã‚’é€šã˜ã¦DARTã‚¯ãƒƒã‚­ãƒ¼ã‚’ç„¡åŠ¹ã«ã§ãã¾ã™'
        },
        {
            title: '4. YouTubeãƒ“ãƒ‡ã‚ªã‚³ãƒ³ãƒ†ãƒ³ãƒ„',
            description: 'ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆdarnafull.comã¯YouTubeã‹ã‚‰ãƒ“ãƒ‡ã‚ªã‚’å…¬å¼ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ï¼ˆiframeï¼‰ã‚’ä½¿ç”¨ã—ã¦åŸ‹ã‚è¾¼ã¿ã€ç‹¬è‡ªã®ã‚µãƒ¼ãƒãƒ¼ã§ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒ›ã‚¹ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚ã™ã¹ã¦ã®ãƒ“ãƒ‡ã‚ªæ¨©ã¯å…ƒã®æ‰€æœ‰è€…ã¨YouTubeã«å±ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ“ãƒ‡ã‚ªã®ä½¿ç”¨ã¯YouTubeã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã¨åˆ©ç”¨è¦ç´„ã®å¯¾è±¡ã§ã™ã€‚'
        },
        {
            title: '5. ã‚³ãƒ¡ãƒ³ãƒˆã¨ç›¸äº’ä½œç”¨',
            items: [
                'ã‚³ãƒ¡ãƒ³ãƒˆå†…å®¹ã¨é€ä¿¡æ™‚é–“ã¯è¡¨ç¤ºã¨ç®¡ç†ã®ç›®çš„ã§ä¿å­˜ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™',
                'æ©Ÿå¯†æƒ…å ±ã‚„å±é™ºãªå€‹äººæƒ…å ±ã¯è¦æ±‚ã—ã¾ã›ã‚“',
                'ã‚³ãƒ¡ãƒ³ãƒˆã¯ãƒã‚¸ãƒ†ã‚£ãƒ–ãªã‚„ã‚Šå–ã‚Šã¨æ„è¦‹ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ç›®çš„ã®ã¿ã§ã™',
                'ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£åŸºæº–ã«é•åã™ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆå‰Šé™¤ã®æ¨©åˆ©ã‚’ä¿æœ‰ã—ã¦ã„ã¾ã™'
            ]
        },
        {
            title: '6. å…ç«¥ä¿è­·',
            description: 'ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆdarnafull.comã¯ã€å®¶æ—å‘ã‘ã®ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ³ãƒ¡ãƒ³ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æä¾›ã—ã€å°Šé‡ã¨å®‰å…¨ãªæ–¹æ³•ã§å¹¼å°‘æœŸã®æ€ã„å‡ºã‚’å¾©æ´»ã•ã›ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚å…ç«¥ã‹ã‚‰å€‹äººãƒ‡ãƒ¼ã‚¿ã‚’æ„å›³çš„ã«åé›†ã—ã¦ã„ã¾ã›ã‚“ã€‚'
        },
        {
            title: '7. å¤–éƒ¨ãƒªãƒ³ã‚¯',
            description: 'ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆdarnafull.comã¯ã€å¤–éƒ¨ã‚µã‚¤ãƒˆï¼ˆYouTubeãªã©ï¼‰ã¸ã®ãƒªãƒ³ã‚¯ã‚’å«ã‚€å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚µã‚¤ãƒˆã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¾ãŸã¯ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã«ã¤ã„ã¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãã‚Œã‚‰ã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚'
        },
        {
            title: '8. ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã¸ã®åŒæ„',
            description: 'darnafull.comã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ã“ã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã¨ãã®ã™ã¹ã¦ã®æ¡ä»¶ã«åŒæ„ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚'
        },
        {
            title: '9. ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã®å¤‰æ›´',
            description: 'ã“ã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã‚’ã„ã¤ã§ã‚‚å¤‰æ›´ã¾ãŸã¯æ›´æ–°ã™ã‚‹æ¨©åˆ©ã‚’ä¿æœ‰ã—ã¦ã„ã¾ã™ã€‚ã™ã¹ã¦ã®å¤‰æ›´ã¯ã“ã®ãƒšãƒ¼ã‚¸ã«æŠ•ç¨¿ã•ã‚Œã€æ”¹è¨‚æ—¥ãŒæ›´æ–°ã•ã‚Œã¾ã™ã€‚'
        }
    ]
};

// ============================================
// DATA
// ============================================
const LIBRARY = {
    series: [
        {
            id: 'doraemon',
            titleKey: 'series.doraemon.title',
            cover: 'covers/doraemon.jpg',
            episodes: [
                {
                    id: 'ep01',
                    titleKey: 'series.doraemon.episode.ep01.title',
                    descriptionKey: 'series.doraemon.episode.ep01.description',
                    cover: 'covers/ep01.jpg',
                    versions: {
                        original: {
                            nameKey: 'original',
                            icon: '&#9658;',
                            id: 'ZYycK1Paq4M'
                        },
                        arabic: {
                            nameKey: 'arabicDub',
                            icon: '&#128266;',
                            id: 'B_Ha4vu-qc8'
                        },
                        japanese: {
                            nameKey: 'japaneseDub',
                            icon: '&#12289;&#12289;',
                            id: 'xYJpOiuPohQ'
                        }
                    }
                }
            ]
        }
    ]
};

// ============================================
// i18n UTILITIES
// ============================================
const I18n = {
    translateElement(element) {
        if (!element) return;

        const contentKey = element.getAttribute('data-i18n-content');
        if (contentKey && i18next.exists(contentKey)) {
            element.setAttribute('content', i18next.t(contentKey));
        }

        const key = element.getAttribute('data-i18n');
        if (!key) return;

        const count = element.getAttribute('data-i18n-count');
        const options = count ? { count: parseInt(count) } : {};

        if (!i18next.exists(key)) {
            console.error(`Translation key not found: "${key}"`);
            return;
        }

        if (element.tagName !== 'INPUT' && element.tagName !== 'TEXTAREA') {
            element.textContent = i18next.t(key, options);
        }

        const placeholderKey = element.getAttribute('data-i18n-placeholder');
        if (placeholderKey && i18next.exists(placeholderKey)) {
            element.placeholder = i18next.t(placeholderKey);
        }

        const titleKey = element.getAttribute('data-i18n-title');
        if (titleKey && i18next.exists(titleKey)) {
            element.title = i18next.t(titleKey);
        }
    },

    translatePage() {
        document.querySelectorAll('[data-i18n], [data-i18n-content]').forEach(el => {
            this.translateElement(el);
        });

        const lang = i18next.language;
        document.documentElement.setAttribute('data-lang', lang);
        document.documentElement.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');
    },

    changeLanguage(lang) {
        i18next.changeLanguage(lang, (err) => {
            if (err) {
                console.error('Language change error:', err);
                return;
            }
            localStorage.setItem('site_lang', lang);
            this.translatePage();
            App.refreshCurrentView();
        });
    },

    t(key, options = {}) {
        if (!i18next.exists(key)) {
            console.error(`Translation key not found: "${key}"`);
            return key;
        }
        return i18next.t(key, options);
    }
};

// ============================================
// UTILITIES
// ============================================
const Utils = {
    sanitize(text) {
        const d = document.createElement('div');
        d.textContent = text;
        return d.innerHTML;
    },

    timeAgo(ts) {
        const diff = Date.now() - ts;
        const m = Math.floor(diff / 60000);

        if (m < 1) return I18n.t('justNow');
        if (m < 60) return I18n.t('minutesAgo', { count: m });
        const h = Math.floor(m / 60);
        if (h < 24) return I18n.t('hoursAgo', { count: h });
        return I18n.t('daysAgo', { count: Math.floor(h / 24) });
    },

    clientId() {
        let id = localStorage.getItem('watch_vip_client_id');
        if (!id) {
            id = Date.now().toString(36) + Math.random().toString(36).slice(2);
            localStorage.setItem('watch_vip_client_id', id);
        }
        return id;
    },

    status(msg, type='info') {
        const el = document.getElementById('statusMessage');
        if (!el) return;
        el.textContent = msg;
        el.className = `status-message ${type} show`;
        setTimeout(()=>el.classList.remove('show'), 4000);
    },

    playHaptic() {
        if (navigator.vibrate) {
            navigator.vibrate(30);
        }
    }
};

// ============================================
// API
// ============================================
const API = {
    async submit(name, text) {
        try {
            const r = await fetch(`${CONFIG.BACKEND_URL}/submit-comment`, {
                method: 'POST',
                headers: {'Content-Type':'application/json'},
                body: JSON.stringify({
                    name, text,
                    clientId: Utils.clientId()
                })
            });
            if (!r.ok) throw new Error('Failed');
            return r.json();
        } catch (e) {
            throw new Error('Connection error');
        }
    },

    async comments() {
        try {
            const r = await fetch(`${CONFIG.BACKEND_URL}/comments`);
            return r.ok ? r.json() : [];
        } catch {
            return [];
        }
    }
};

// ============================================
// DUB ENGINE
// ============================================
const DubEngine = {
    state: {
        isReady: false,
        currentMode: 'original',
        mainPlayer: null,
        audioPlayers: {}
    },

    async init(mainId, versions) {
        this.cleanup();

        const container = document.getElementById('videoContainer');
        if (!container) return;

        let html = `<iframe id="dub-main"
            src="https://www.youtube.com/embed/${mainId}?enablejsapi=1&controls=1&modestbranding=1&rel=0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen></iframe>`;

        Object.entries(versions).forEach(([key, version]) => {
            if (key !== 'original') {
                html += `<iframe id="dub-${key}"
                    src="https://www.youtube.com/embed/${version.id}?enablejsapi=1&controls=0&modestbranding=1&rel=0"
                    style="display:none"
                    allow="autoplay; encrypted-media"></iframe>`;
            }
        });

        container.innerHTML = html;

        this.state.currentMode = 'original';
        this.state.isReady = false;

        if (YTReady) {
            this.setupPlayersWhenReady();
        }
    },

    setupPlayersWhenReady() {
        if (!window.YT || !window.YT.Player) {
            setTimeout(() => this.setupPlayersWhenReady(), 500);
            return;
        }

        try {
            const mainEl = document.getElementById('dub-main');
            if (mainEl) {
                this.state.mainPlayer = new YT.Player('dub-main', {
                    events: {
                        'onReady': () => {
                            this.state.isReady = true;
                            console.log('Main player ready');
                            this.updateControlButtons();
                        }
                    }
                });
            }
        } catch (e) {
            console.error('Main player error:', e);
        }

        document.querySelectorAll('[id^="dub-"]').forEach(el => {
            if (el.id === 'dub-main') return;
            
            const key = el.id.replace('dub-', '');
            try {
                this.state.audioPlayers[key] = new YT.Player(el.id, {
                    events: {
                        'onReady': () => {
                            console.log(`Audio player ${key} ready`);
                            this.updateControlButtons();
                        }
                    }
                });
            } catch (e) {
                console.error(`Audio player ${key} error:`, e);
            }
        });
    },

    setMode(mode) {
        if (mode === this.state.currentMode) return;

        try {
            if (mode === 'original') {
                if (this.state.mainPlayer && typeof this.state.mainPlayer.unMute === 'function') {
                    this.state.mainPlayer.unMute();
                }
                
                Object.values(this.state.audioPlayers).forEach(player => {
                    try {
                        if (player && typeof player.pauseVideo === 'function') {
                            player.pauseVideo();
                        }
                        if (player && typeof player.mute === 'function') {
                            player.mute();
                        }
                    } catch (e) {}
                });
            } else {
                if (this.state.mainPlayer && typeof this.state.mainPlayer.mute === 'function') {
                    this.state.mainPlayer.mute();
                }
                
                Object.entries(this.state.audioPlayers).forEach(([key, player]) => {
                    try {
                        if (!player) return;

                        if (key === mode) {
                            if (typeof player.unMute === 'function') {
                                player.unMute();
                            }
                            
                            if (this.state.mainPlayer && typeof this.state.mainPlayer.getCurrentTime === 'function') {
                                const mainTime = this.state.mainPlayer.getCurrentTime();
                                if (typeof player.seekTo === 'function') {
                                    player.seekTo(mainTime, true);
                                }
                            }
                            
                            setTimeout(() => {
                                if (this.state.mainPlayer && 
                                    this.state.mainPlayer.getPlayerState && 
                                    this.state.mainPlayer.getPlayerState() === YT.PlayerState.PLAYING &&
                                    typeof player.playVideo === 'function') {
                                    player.playVideo();
                                }
                            }, 200);
                        } else {
                            if (typeof player.pauseVideo === 'function') {
                                player.pauseVideo();
                            }
                            if (typeof player.mute === 'function') {
                                player.mute();
                            }
                        }
                    } catch (e) {}
                });
            }

            this.state.currentMode = mode;
            this.updateControlButtons();
            console.log('Mode changed to:', mode);
        } catch (e) {
            console.error('Error setting mode:', e);
        }
    },

    adjustTime(offset) {
        if (this.state.currentMode === 'original') {
            console.warn('Cannot adjust time in original mode');
            return;
        }

        const audioPlayer = this.state.audioPlayers[this.state.currentMode];
        
        if (!audioPlayer || typeof audioPlayer.seekTo !== 'function' || typeof audioPlayer.getCurrentTime !== 'function') {
            console.warn('No valid audio player for time adjustment');
            return;
        }

        try {
            const currentTime = audioPlayer.getCurrentTime();
            
            if (currentTime === undefined || isNaN(currentTime)) {
                console.warn('Invalid current time from audio player');
                return;
            }

            const newTime = Math.max(0, currentTime + offset);
            
            console.log(`Manual adjustment: ${currentTime.toFixed(2)}s -> ${newTime.toFixed(2)}s (${offset > 0 ? '+' : ''}${offset}s)`);
            
            audioPlayer.seekTo(newTime, true);
            
            Utils.playHaptic();
            
        } catch (e) {
            console.error('Error adjusting audio time:', e);
        }
    },

    updateControlButtons() {
        const controlButtons = document.querySelectorAll('#dubControls .control-btn');
        const isAudioPlayerReady = this.state.currentMode !== 'original' && 
                                   this.state.audioPlayers[this.state.currentMode];

        controlButtons.forEach(btn => {
            if (isAudioPlayerReady && this.state.isReady) {
                btn.disabled = false;
                btn.style.opacity = '1';
            } else {
                btn.disabled = true;
                btn.style.opacity = '0.3';
            }
        });
    },

    cleanup() {
        this.state.mainPlayer = null;
        this.state.audioPlayers = {};
        this.state.isReady = false;
        this.state.currentMode = 'original';
    }
};

// ============================================
// APPLICATION STATE
// ============================================
const App = {
    currentView: 'home',
    currentSeries: null,
    currentEpisode: null,
    dubEnabled: false,
    lastDubMode: localStorage.getItem('last_dub') || 'arabic',
    dubSelectorVisible: false,
    dubToggleLongPressTimer: null,

    init() {
        if (!i18next.isInitialized) {
            i18next.init({
                lng: localStorage.getItem('site_lang') || 'ar',
                fallbackLng: false,
                resources: i18nResources,
                interpolation: {
                    escapeValue: false
                }
            }).then(() => {
                I18n.translatePage();
                this.restoreState();
            });
        } else {
            I18n.translatePage();
            this.restoreState();
        }

        Comments.init();
        this.setupDubToggle();
        this.setupLanguageToggle();
    },

    restoreState() {
        const saved = sessionStorage.getItem('last_view');

        if (saved) {
            try {
                const state = JSON.parse(saved);

                if (state.view === 'video') {
                    this.currentSeries = LIBRARY.series.find(s => s.id === state.seriesId);
                    if (this.currentSeries) {
                        this.playEpisode(state.episodeId);
                    } else {
                        this.renderHome();
                    }
                } 
                else if (state.view === 'series') {
                    this.viewSeries(state.seriesId);
                } 
                else {
                    this.renderHome();
                }
            } catch (e) {
                this.renderHome();
            }
        } else {
            this.renderHome();
        }
    },

    setupLanguageToggle() {
        const langToggle = document.getElementById('langToggle');
        const langMenu = document.getElementById('langMenu');

        if (!langToggle || !langMenu) return;

        langToggle.addEventListener('click', () => {
            langMenu.classList.toggle('hidden');
        });

        document.addEventListener('click', (e) => {
            if (!langToggle.contains(e.target) && !langMenu.contains(e.target)) {
                langMenu.classList.add('hidden');
            }
        });

        langMenu.querySelectorAll('button[data-lang]').forEach(btn => {
            btn.addEventListener('click', () => {
                const lang = btn.getAttribute('data-lang');
                I18n.changeLanguage(lang);
                langMenu.classList.add('hidden');
                
                langMenu.querySelectorAll('button[data-lang]').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            });
        });

        const currentLang = i18next.language;
        langMenu.querySelector(`button[data-lang="${currentLang}"]`)?.classList.add('active');
    },

    refreshCurrentView() {
        if (this.currentView === 'home') {
            this.renderHome();
        }
        else if (this.currentView === 'series' && this.currentSeries) {
            this.viewSeries(this.currentSeries.id);
        }
        else if (this.currentView === 'video' && this.currentEpisode) {
            const episodeId = this.currentEpisode.id;
            const dubState = this.dubEnabled;
            const dubMode = this.lastDubMode;
            
            this.playEpisode(episodeId).then(() => {
                if (dubState) {
                    setTimeout(() => {
                        this.selectDubVersion(dubMode, document.querySelector(`.dub-btn[onclick*="${dubMode}"]`));
                    }, 1000);
                }
            });
        }
        else if (this.currentView === 'privacy') {
            this.viewPrivacy();
        }
        
        I18n.translatePage();
    },

    setupDubToggle() {
        const btn = document.getElementById('dubToggle');
        if (!btn) return;

        let isLongPress = false;

        const handleDubToggle = () => {
            if (App.currentView !== 'video') return;
            App.toggleDub();
        };

        const handleDubMenu = () => {
            if (App.currentView !== 'video') return;
            App.toggleDubSelector();
        };

        btn.addEventListener('mousedown', () => {
            if (App.currentView !== 'video') return;
            isLongPress = false;
            App.dubToggleLongPressTimer = setTimeout(() => {
                isLongPress = true;
                handleDubMenu();
            }, CONFIG.LONG_PRESS_DURATION);
        });

        btn.addEventListener('mouseup', () => {
            if (App.dubToggleLongPressTimer) {
                clearTimeout(App.dubToggleLongPressTimer);
            }
            if (!isLongPress) {
                handleDubToggle();
            }
        });

        btn.addEventListener('touchstart', (e) => {
            if (App.currentView !== 'video') return;
            isLongPress = false;
            App.dubToggleLongPressTimer = setTimeout(() => {
                isLongPress = true;
                handleDubMenu();
            }, CONFIG.LONG_PRESS_DURATION);
        });

        btn.addEventListener('touchend', (e) => {
            if (App.dubToggleLongPressTimer) {
                clearTimeout(App.dubToggleLongPressTimer);
            }
            e.preventDefault();
            if (!isLongPress) {
                handleDubToggle();
            }
        });

        btn.addEventListener('contextmenu', (e) => e.preventDefault());
    },

    toggleDub() {
        Utils.playHaptic();
        this.dubEnabled = !this.dubEnabled;

        const btn = document.getElementById('dubToggle');
        const iconEl = btn ? btn.querySelector('.icon') : null;
        const preDubNotice = document.getElementById('preDubNotice');
        const dubControls = document.getElementById('dubControls');
        
        if (this.dubEnabled) {
            if (btn) btn.classList.add('active');
            if (iconEl) iconEl.innerHTML = '&#128266;';
            DubEngine.setMode(this.lastDubMode);
            
            if (preDubNotice) preDubNotice.classList.add('hidden');
            if (dubControls) dubControls.classList.remove('hidden');
        } else {
            if (btn) btn.classList.remove('active');
            if (iconEl) iconEl.textContent = 'X';
            DubEngine.setMode('original');
            
            if (dubControls) dubControls.classList.add('hidden');
            if (preDubNotice) preDubNotice.classList.remove('hidden');
        }
    },

    toggleDubSelector() {
        const selector = document.getElementById('dubSelector');
        if (!selector) return;

        this.dubSelectorVisible = !this.dubSelectorVisible;

        if (this.dubSelectorVisible) {
            selector.style.display = 'block';
            selector.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        } else {
            selector.style.display = 'none';
        }
    },

    renderHome() {
        const libraryView = document.getElementById('libraryView');
        const videoView = document.getElementById('videoView');
        const privacyView = document.getElementById('privacyView');
        const backBtn = document.getElementById('backBtn');

        if (libraryView) libraryView.classList.remove('hidden');
        if (videoView) videoView.classList.add('hidden');
        if (privacyView) privacyView.classList.add('hidden');
        if (backBtn) backBtn.style.display = 'none';
        
        const breadcrumb = document.getElementById('breadcrumbText');
        if (breadcrumb) {
            breadcrumb.setAttribute('data-i18n', 'library');
            I18n.translateElement(breadcrumb);
        }

        const grid = document.getElementById('libraryGrid');
        if (grid) {
            grid.innerHTML = LIBRARY.series.map(series => `
                <div class="library-item" onclick="App.viewSeries('${series.id}')">
                    <div class="item-cover">
                        <img src="${series.cover}" alt="${I18n.t(series.titleKey)}">
                    </div>
                    <div class="item-info">
                        <div class="item-title">${Utils.sanitize(I18n.t(series.titleKey))}</div>
                        <div class="item-subtitle">${I18n.t('episodeCount', {count: series.episodes.length})}</div>
                    </div>
                </div>
            `).join('');
        }

        this.currentView = 'home';
        this.dubSelectorVisible = false;
        Comments.pauseAutoRefresh();
        DubEngine.cleanup();

        sessionStorage.removeItem('last_view');
        I18n.translatePage();
    },

    viewSeries(seriesId) {
        this.currentSeries = LIBRARY.series.find(s => s.id === seriesId);
        if (!this.currentSeries) return;

        const libraryView = document.getElementById('libraryView');
        const videoView = document.getElementById('videoView');
        const privacyView = document.getElementById('privacyView');
        const backBtn = document.getElementById('backBtn');

        if (libraryView) libraryView.classList.remove('hidden');
        if (videoView) videoView.classList.add('hidden');
        if (privacyView) privacyView.classList.add('hidden');
        if (backBtn) {
            backBtn.style.display = 'inline-flex';
            backBtn.setAttribute('data-i18n', 'back');
            I18n.translateElement(backBtn);
        }
        
        const libraryTitle = document.getElementById('libraryTitle');
        const breadcrumbText = document.getElementById('breadcrumbText');

        if (libraryTitle) {
            libraryTitle.textContent = I18n.t(this.currentSeries.titleKey);
        }
        if (breadcrumbText) {
            breadcrumbText.textContent = I18n.t(this.currentSeries.titleKey);
        }

        const grid = document.getElementById('libraryGrid');
        if (grid) {
            grid.innerHTML = this.currentSeries.episodes.map(ep => {
                return `
                    <div class="library-item" onclick="App.playEpisode('${ep.id}')">
                        <div class="item-cover episode" style="background-image: url('${ep.cover}')">
                            <span class="play-icon">&#9658;</span>
                        </div>
                        <div class="item-info">
                            <div class="item-title">${Utils.sanitize(I18n.t(ep.titleKey))}</div>
                            <div class="item-subtitle">${Utils.sanitize(I18n.t(ep.descriptionKey))}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        this.currentView = 'series';
        this.dubSelectorVisible = false;
        Comments.pauseAutoRefresh();
        DubEngine.cleanup();

        sessionStorage.setItem('last_view', JSON.stringify({
            view: 'series',
            seriesId
        }));
        
        I18n.translatePage();
    },

    async playEpisode(episodeId) {
        if (!this.currentSeries) return;
        this.currentEpisode = this.currentSeries.episodes.find(e => e.id === episodeId);
        if (!this.currentEpisode) return;

        const libraryView = document.getElementById('libraryView');
        const videoView = document.getElementById('videoView');
        const privacyView = document.getElementById('privacyView');
        const backBtn = document.getElementById('backBtn');

        if (libraryView) libraryView.classList.add('hidden');
        if (videoView) videoView.classList.remove('hidden');
        if (privacyView) privacyView.classList.add('hidden');
        if (backBtn) {
            backBtn.style.display = 'inline-flex';
            backBtn.setAttribute('data-i18n', 'back');
            I18n.translateElement(backBtn);
        }
        
        const breadcrumbText = document.getElementById('breadcrumbText');
        const videoTitle = document.getElementById('videoTitle');
        const videoDescription = document.getElementById('videoDescription');

        if (breadcrumbText) {
            breadcrumbText.textContent = I18n.t(this.currentEpisode.titleKey);
        }
        if (videoTitle) {
            videoTitle.textContent = I18n.t(this.currentEpisode.titleKey);
        }
        if (videoDescription) {
            videoDescription.textContent = I18n.t(this.currentEpisode.descriptionKey);
        }

        this.setupDubButtons();

        const mainId = this.currentEpisode.versions.original.id;
        await DubEngine.init(mainId, this.currentEpisode.versions);

        this.dubEnabled = false;
        this.dubSelectorVisible = false;
        
        const dubToggleBtn = document.getElementById('dubToggle');
        if (dubToggleBtn) {
            dubToggleBtn.classList.remove('active');
            const iconEl = dubToggleBtn.querySelector('.icon');
            if (iconEl) {
                iconEl.textContent = 'X';
            }
        }

        const preDubNotice = document.getElementById('preDubNotice');
        const dubControls = document.getElementById('dubControls');

        if (preDubNotice) preDubNotice.classList.remove('hidden');
        if (dubControls) dubControls.classList.add('hidden');

        this.currentView = 'video';
        Comments.load();

        sessionStorage.setItem('last_view', JSON.stringify({
            view: 'video',
            seriesId: this.currentSeries.id,
            episodeId
        }));
        
        I18n.translatePage();
    },

    viewPrivacy() {
        const libraryView = document.getElementById('libraryView');
        const videoView = document.getElementById('videoView');
        const privacyView = document.getElementById('privacyView');
        const backBtn = document.getElementById('backBtn');

        if (libraryView) libraryView.classList.add('hidden');
        if (videoView) videoView.classList.add('hidden');
        if (privacyView) privacyView.classList.remove('hidden');
        if (backBtn) {
            backBtn.style.display = 'inline-flex';
            backBtn.setAttribute('data-i18n', 'back');
            I18n.translateElement(backBtn);
        }

        const breadcrumbText = document.getElementById('breadcrumbText');
        if (breadcrumbText) {
            breadcrumbText.setAttribute('data-i18n', 'privacyTitle');
            I18n.translateElement(breadcrumbText);
        }

        const privacyContent = document.getElementById('privacyContent');
        const lang = i18next.language;
        const content = PRIVACY_CONTENT[lang] || PRIVACY_CONTENT.ar;

        if (privacyContent) {
            privacyContent.innerHTML = content.map((section, idx) => `
                <div class="privacy-section">
                    <h2>${section.title}</h2>
                    ${section.description ? `<p>${section.description}</p>` : ''}
                    ${section.items ? `
                        <ul>
                            ${section.items.map(item => `<li>${item}</li>`).join('')}
                        </ul>
                    ` : ''}
                </div>
            `).join('');
        }

        this.currentView = 'privacy';
        Comments.pauseAutoRefresh();
        DubEngine.cleanup();

        sessionStorage.removeItem('last_view');
        I18n.translatePage();
    },

    setupDubButtons() {
        const versions = this.currentEpisode.versions;
        const dubButtons = document.getElementById('dubButtons');
        const dubSelector = document.getElementById('dubSelector');

        if (!dubButtons || !dubSelector) return;

        if (!versions || Object.keys(versions).length <= 1) {
            dubSelector.style.display = 'none';
            return;
        }

        dubSelector.style.display = 'none';
        this.dubSelectorVisible = false;

        dubButtons.innerHTML = Object.entries(versions).map(([key, version]) => {
            const icon = version.icon;
            const name = I18n.t(version.nameKey);
            
            return `
                <button 
                    class="dub-btn ${key === 'original' ? 'active' : ''}" 
                    onclick="App.selectDubVersion('${key}', this)"
                >
                    <span class="dub-icon">${icon}</span>
                    <span>${name}</span>
                </button>
            `;
        }).join('');

        this.updateStatusIndicator('original');
    },

    updateStatusIndicator(mode) {
        const statusText = document.getElementById('statusText');
        if (!statusText) return;
        
        const statusKeys = {
            original: 'statusOriginal',
            arabic: 'statusArabic',
            japanese: 'statusJapanese'
        };

        const icons = {
            original: '&#9658;',
            arabic: '&#128266;',
            japanese: '&#12289;&#12289;'
        };

        const statusIcon = icons[mode] || icons.original;
        const statusMessage = I18n.t(statusKeys[mode] || statusKeys.original);
        
        statusText.innerHTML = `${statusIcon} ${statusMessage}`;
    },

    selectDubVersion(versionKey, button) {
        Utils.playHaptic();

        document.querySelectorAll('.dub-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        if (button) button.classList.add('active');

        this.updateStatusIndicator(versionKey);

        const dubToggle = document.getElementById('dubToggle');
        const iconEl = dubToggle ? dubToggle.querySelector('.icon') : null;
        const preDubNotice = document.getElementById('preDubNotice');
        const dubControls = document.getElementById('dubControls');

        if (versionKey === 'original') {
            this.dubEnabled = false;
            if (dubToggle) dubToggle.classList.remove('active');
            if (iconEl) iconEl.textContent = 'X';
            DubEngine.setMode('original');
            
            if (dubControls) dubControls.classList.add('hidden');
            if (preDubNotice) preDubNotice.classList.remove('hidden');
        } else {
            this.lastDubMode = versionKey;
            localStorage.setItem('last_dub', versionKey);
            this.dubEnabled = true;
            if (dubToggle) dubToggle.classList.add('active');
            if (iconEl) iconEl.innerHTML = '&#128266;';
            DubEngine.setMode(versionKey);
            
            if (preDubNotice) preDubNotice.classList.add('hidden');
            if (dubControls) dubControls.classList.remove('hidden');
        }
    },

    goHome() {
        if (this.currentView === 'video') {
            this.viewSeries(this.currentSeries.id);
        } else if (this.currentView === 'series') {
            this.renderHome();
        } else if (this.currentView === 'privacy') {
            this.renderHome();
        }
    }
};

// ============================================
// COMMENTS MANAGER
// ============================================
const Comments = {
    userCommentId: localStorage.getItem('watch_vip_user_comment_id'),
    autoRefreshInterval: null,
    isRefreshing: false,
    lastSubmitTime: 0,

    async init() {
        const form = document.getElementById('commentForm');
        if (form) {
            form.addEventListener('submit', e => {
                e.preventDefault();
                this.send();
            });
        }

        this.startAutoRefresh();
    },

    startAutoRefresh() {
        if (this.autoRefreshInterval) clearInterval(this.autoRefreshInterval);

        const indicator = document.getElementById('updateIndicator');
        if (indicator) {
            indicator.classList.remove('paused');
        }

        this.autoRefreshInterval = setInterval(() => {
            if (App.currentView === 'video') {
                this.load();
            }
        }, CONFIG.REFRESH_INTERVAL);
    },

    pauseAutoRefresh() {
        if (this.autoRefreshInterval) {
            clearInterval(this.autoRefreshInterval);
            this.autoRefreshInterval = null;
        }

        const indicator = document.getElementById('updateIndicator');
        if (indicator) {
            indicator.classList.add('paused');
        }
    },

    async send() {
        const now = Date.now();

        if (now - this.lastSubmitTime < CONFIG.SUBMIT_COOLDOWN) {
            Utils.status(I18n.t('rateLimitError'), 'error');
            return;
        }

        if (this.userCommentId) {
            Utils.status(I18n.t('pending'), 'info');
            return;
        }

        const nameEl = document.getElementById('commentName');
        const textEl = document.getElementById('commentText');

        if (!nameEl || !textEl) return;

        const name = nameEl.value.trim();
        const text = textEl.value.trim();

        if (!text) {
            Utils.status(I18n.t('empty'), 'error');
            return;
        }

        const btn = document.getElementById('submitBtn');
        if (!btn) return;

        btn.disabled = true;
        btn.textContent = I18n.t('submitting');

        try {
            const res = await API.submit(name || null, text);
            this.userCommentId = res.commentId;
            localStorage.setItem('watch_vip_user_comment_id', res.commentId);
            this.lastSubmitTime = now;
            
            Utils.status(I18n.t('success'), 'success');
            Utils.playHaptic();
            
            textEl.value = '';
            nameEl.value = '';
            await this.load();
        } catch (e) {
            Utils.status(I18n.t('error'), 'error');
        } finally {
            btn.disabled = false;
            btn.setAttribute('data-i18n', 'submit');
            I18n.translateElement(btn);
        }
    },

    async load() {
        if (this.isRefreshing || App.currentView !== 'video') return;
        this.isRefreshing = true;

        try {
            const list = await API.comments();
            const box = document.getElementById('commentsListContainer');
            if (!box) {
                this.isRefreshing = false;
                return;
            }

            const countEl = document.getElementById('commentsCount');
            if (countEl) {
                countEl.setAttribute('data-i18n', 'commentCount');
                countEl.setAttribute('data-i18n-count', list.length);
                I18n.translateElement(countEl);
            }

            if (!list.length) {
                box.innerHTML = `<div class="no-comments" data-i18n="noComments">${I18n.t('noComments')}</div>`;
                this.isRefreshing = false;
                return;
            }

            if (this.userCommentId && !list.some(c => c.commentId === this.userCommentId)) {
                localStorage.removeItem('watch_vip_user_comment_id');
                this.userCommentId = null;
            }

            list.sort((a,b)=>{
                if (a.commentId === this.userCommentId) return -1;
                if (b.commentId === this.userCommentId) return 1;
                return b.timestamp - a.timestamp;
            });

            box.innerHTML = `
                <div class="comments-list">
                    ${list.map(c=>`
                        <div class="comment-item ${c.commentId===this.userCommentId?'user-comment':''}"
                             data-id="${c.commentId}">
                            <div class="comment-header">
                                <div class="comment-author">
                                    ${Utils.sanitize(c.displayName)}
                                    ${c.verified ? `<svg class="verified-svg" viewBox="0 0 24 24" fill="#1da1f2">
                                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/>
                                    </svg>` : ''}
                                </div>
                                <span class="comment-time">${Utils.timeAgo(c.timestamp)}</span>
                            </div>
                            <div class="comment-text">${Utils.sanitize(c.text)}</div>
                        </div>
                    `).join('')}
                </div>
            `;

            this.bindClicks();
        } finally {
            this.isRefreshing = false;
        }
    },

    bindClicks() {
        document.querySelectorAll('.user-comment').forEach(el=>{
            let lastClick = 0;
            el.addEventListener('click', () => {
                const now = Date.now();
                if (now - lastClick < 300) {
                    localStorage.removeItem('watch_vip_user_comment_id');
                    this.userCommentId = null;
                    Utils.status(I18n.t('canComment'), 'success');
                    Utils.playHaptic();
                    this.load();
                }
                lastClick = now;
            });
        });
    }
};

// ============================================
// INITIALIZATION
// ============================================
document.addEventListener('DOMContentLoaded', () => {
    App.init();
});
    </script>
</body>
</html>
