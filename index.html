<!DOCTYPE html>
<html lang="ar" dir="rtl" data-lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" data-i18n-content="metaDescription">
    <title data-i18n="appTitle"></title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9RXK5ZKJD6"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-9RXK5ZKJD6', {
            'anonymize_ip': true,
            'allow_ad_personalization_signals': false
        });
    </script>
    
    <style>
        /* ===========================
           Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙˆØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø¹Ø§Ù…Ø©
        =========================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #ff0000;
            --secondary-color: #282828;
            --bg-dark: #0f0f0f;
            --bg-light: #1f1f1f;
            --text-primary: #ffffff;
            --text-secondary: #aaaaaa;
            --border-color: #303030;
            --success-color: #00ff00;
            --verified-color: #1da1f2;
            --shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        html[data-lang="ar"] body {
            font-family: 'Cairo', sans-serif;
            direction: rtl;
        }

        html[data-lang="en"] body,
        html[data-lang="fr"] body {
            font-family: 'Inter', sans-serif;
            direction: ltr;
        }

        html[data-lang="ja"] body {
            font-family: 'Noto Sans JP', sans-serif;
            direction: ltr;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding: 10px 15px;
            background: var(--bg-light);
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .breadcrumb button {
            background: var(--secondary-color);
            border: 1px solid var(--border-color);
            color: var(--verified-color);
            cursor: pointer;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 6px;
            transition: all 0.3s;
            font-size: 0.9rem;
            font-family: inherit;
        }

        .breadcrumb button:hover {
            background: var(--primary-color);
            color: var(--text-primary);
            border-color: var(--primary-color);
        }

        .library-view {
            margin-bottom: 30px;
        }

        .library-header {
            padding: 15px 20px;
            background: var(--secondary-color);
            border-radius: 12px 12px 0 0;
            border-bottom: 1px solid var(--border-color);
        }

        .library-header h1 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .library-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            padding: 20px;
            background: var(--bg-light);
            border-radius: 0 0 12px 12px;
        }

        .library-item {
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 8px;
            overflow: hidden;
            background: var(--secondary-color);
            border: 2px solid transparent;
        }

        .library-item:hover {
            border-color: var(--primary-color);
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .item-cover {
            width: 100%;
            aspect-ratio: 16 / 9;
            background-color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .item-cover.episode {
            background-size: cover;
            background-position: 25% center;
        }

        .item-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .play-icon {
            position: absolute;
            font-size: 3rem;
            color: rgba(255, 255, 255, 0.9);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.7);
            pointer-events: none;
        }

        .item-info {
            padding: 15px;
        }

        .item-title {
            font-weight: 600;
            margin-bottom: 8px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .item-subtitle {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .video-section {
            background: var(--bg-light);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .video-header {
            padding: 15px 20px;
            background: var(--secondary-color);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .video-header h1 {
            font-size: 1.5rem;
            font-weight: 600;
            flex: 1;
        }

        .video-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            background: #000;
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        .quick-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sys-toggle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: #2a2a2a;
            color: #aaa;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.25s ease;
            box-shadow: inset 0 0 0 2px #333;
            font-family: inherit;
            user-select: none;
        }

        .sys-toggle:hover {
            background: #333;
        }

        .sys-toggle.active {
            background: var(--primary-color);
            color: #fff;
            box-shadow: 0 0 12px rgba(255, 0, 0, 0.6), inset 0 0 0 2px rgba(255,255,255,0.3);
        }

        .control-panel {
            background: var(--secondary-color);
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }

        .dub-notice {
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-align: center;
            padding: 10px 14px;
            line-height: 1.5;
        }

        .control-buttons {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
        }

        .control-btn-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: center;
        }

        .control-btn {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: #1f1f1f;
            border: 2px solid #333;
            color: #fff;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
            position: relative;
        }

        .control-btn:hover:not(:disabled) {
            background: var(--primary-color);
            border-color: var(--primary-color);
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
        }

        .control-btn:active:not(:disabled) {
            transform: scale(0.95);
        }

        .control-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .control-btn-small {
            width: 45px;
            height: 45px;
            font-size: 16px;
            background: #151515;
            border: 2px solid #282828;
        }

        .control-btn-small:hover:not(:disabled) {
            background: #cc0000;
            border-color: #cc0000;
        }

        .btn-label {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 4px;
            font-weight: 500;
        }

        .dub-selector {
            background: var(--secondary-color);
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 0;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                max-height: 0;
                overflow: hidden;
            }
            to {
                opacity: 1;
                max-height: 500px;
            }
        }

        .dub-selector h3 {
            margin-bottom: 12px;
            font-size: 0.95rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .dub-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .dub-btn {
            padding: 10px 18px;
            background: var(--bg-dark);
            border: 2px solid var(--border-color);
            color: var(--text-primary);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s;
            font-family: inherit;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .dub-btn:hover {
            border-color: var(--text-secondary);
            background: var(--bg-light);
        }

        .dub-btn.active {
            border-color: var(--primary-color);
            background: var(--primary-color);
            color: var(--text-primary);
            font-weight: 600;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }

        .dub-icon {
            font-size: 1.1rem;
        }

        .dub-status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            background: rgba(255, 0, 0, 0.1);
            border-radius: 6px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: #ff0000;
            border: 1px solid rgba(255, 0, 0, 0.2);
        }

        .dub-status-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #aaa;
            border-radius: 50%;
        }

        .dub-status-dot.active {
            background: var(--success-color);
            animation: pulse 1.5s ease-in-out infinite;
        }

        .video-info {
            padding: 20px;
        }

        .video-title {
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .video-description {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        .comments-section {
            background: var(--bg-light);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .comments-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .comments-header h2 {
            font-size: 1.4rem;
            font-weight: 600;
        }

        .comments-count {
            background: var(--secondary-color);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .comment-form {
            margin-bottom: 30px;
            padding: 20px;
            background: var(--secondary-color);
            border-radius: 8px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            background: var(--bg-dark);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: var(--text-secondary);
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            background: var(--bg-dark);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-hint {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .submit-btn {
            width: 100%;
            padding: 12px;
            background: var(--primary-color);
            color: var(--text-primary);
            border: 1px solid var(--primary-color);
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
        }

        .submit-btn:hover:not(:disabled) {
            background: #cc0000;
            border-color: #cc0000;
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .status-message {
            padding: 12px 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            font-size: 0.9rem;
            display: none;
        }

        .status-message.show {
            display: block;
        }

        .status-message.success {
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid var(--success-color);
            color: var(--success-color);
        }

        .status-message.error {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
        }

        .status-message.info {
            background: rgba(29, 161, 242, 0.1);
            border: 1px solid var(--verified-color);
            color: var(--verified-color);
        }

        .comments-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .comment-item {
            background: var(--secondary-color);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            transition: all 0.3s;
            cursor: pointer;
        }

        .comment-item:hover {
            border-color: var(--text-secondary);
        }

        .comment-item.user-comment {
            border: 2px solid var(--primary-color);
            background: rgba(255, 0, 0, 0.05);
        }

        .comment-item.admin-comment {
            border: 2px solid var(--verified-color);
            background: rgba(29, 161, 242, 0.05);
        }

        .comment-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .comment-author {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .admin-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .verified-badge {
            display: inline-flex;
            align-items: center;
            color: var(--verified-color);
        }

        .verified-svg {
            width: 14px;
            height: 14px;
            margin-inline-start: 4px;
        }

        .comment-time {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .comment-text {
            color: var(--text-primary);
            line-height: 1.6;
            word-wrap: break-word;
        }

        .comment-actions {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--border-color);
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .click-count {
            font-weight: 500;
        }

        .no-comments {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: var(--text-secondary);
        }

        .hidden {
            display: none !important;
        }

        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            background: var(--secondary-color);
            color: var(--verified-color);
            border: 1px solid var(--border-color);
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
            font-family: inherit;
            font-weight: 500;
        }

        .back-btn:hover {
            background: var(--primary-color);
            color: var(--text-primary);
            border-color: var(--primary-color);
        }

        #langToggle {
            position: fixed;
            right: 20px;
            bottom: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-color);
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 9999;
            font-size: 1.2rem;
            font-weight: 600;
            border: 2px solid var(--text-primary);
            transition: all 0.3s;
            box-shadow: var(--shadow);
            text-align: center;
            padding: 5px;
        }

        #langToggle:hover {
            transform: scale(1.1);
            background: #cc0000;
        }

        #langMenu {
            position: fixed;
            right: 20px;
            bottom: 80px;
            background: var(--bg-light);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            z-index: 9999;
            box-shadow: var(--shadow);
            min-width: 140px;
        }

        #langMenu button {
            display: block;
            width: 100%;
            padding: 12px 16px;
            background: var(--secondary-color);
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            font-size: 0.9rem;
            font-family: inherit;
            font-weight: 500;
        }

        #langMenu button:hover {
            background: var(--primary-color);
            color: var(--text-primary);
        }

        #langMenu button.active {
            background: var(--primary-color);
            color: var(--text-primary);
            font-weight: 700;
        }

        .spinner {
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .comments-update-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: var(--primary-color);
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 1.5s ease-in-out infinite;
        }

        .comments-update-indicator.paused {
            animation: none;
            opacity: 0.5;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .library-item, .comment-item {
            animation: fadeIn 0.3s ease-out;
        }

        /* Footer Styles */
        .site-footer {
            background: var(--bg-light);
            border-top: 1px solid var(--border-color);
            margin-top: 60px;
            padding: 40px 20px 20px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .footer-section h3 {
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .footer-section p,
        .footer-section a {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.8;
        }

        .footer-section a {
            text-decoration: none;
            transition: color 0.3s;
            display: block;
            margin-bottom: 8px;
        }

        .footer-section a:hover {
            color: var(--primary-color);
        }

        .footer-bottom {
            max-width: 1200px;
            margin: 0 auto;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 0.3s ease-out;
        }

        .modal-content {
            background: var(--bg-light);
            border-radius: 12px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            padding: 20px 25px;
            background: var(--secondary-color);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .modal-header h2 {
            font-size: 1.4rem;
            font-weight: 600;
        }

        .modal-close {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 1.8rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: var(--primary-color);
            color: var(--text-primary);
        }

        .modal-body {
            padding: 25px;
        }

        .modal-body h3 {
            font-size: 1.2rem;
            margin-top: 25px;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .modal-body h3:first-child {
            margin-top: 0;
        }

        .modal-body p,
        .modal-body ul {
            color: var(--text-secondary);
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .modal-body ul {
            padding-inline-start: 25px;
        }

        .modal-body li {
            margin-bottom: 10px;
        }

        .modal-body strong {
            color: var(--text-primary);
        }

        .modal-body a {
            color: var(--verified-color);
            text-decoration: none;
            transition: color 0.3s;
        }

        .modal-body a:hover {
            color: var(--primary-color);
        }

        .highlight-box {
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid rgba(255, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .library-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 15px;
            }

            .video-header {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }

            .video-header h1 {
                font-size: 1.2rem;
            }

            .video-title {
                font-size: 1.1rem;
            }

            .comments-header h2 {
                font-size: 1.2rem;
            }

            .comment-form {
                padding: 15px;
            }

            .dub-buttons {
                flex-direction: column;
            }

            .dub-btn {
                width: 100%;
                justify-content: center;
            }

            .video-controls {
                width: 100%;
                justify-content: flex-start;
            }

            .control-panel {
                flex-direction: column;
                gap: 12px;
            }

            .control-buttons {
                width: 100%;
                justify-content: center;
                gap: 10px;
            }

            .control-btn {
                width: 50px;
                height: 50px;
                font-size: 18px;
            }

            .control-btn-small {
                width: 40px;
                height: 40px;
                font-size: 14px;
            }

            .footer-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .modal-content {
                max-height: 95vh;
            }

            .modal-header {
                padding: 15px 20px;
            }

            .modal-body {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">

        <!-- Breadcrumb -->
        <div class="breadcrumb" id="breadcrumb">
            <button
                class="back-btn"
                id="backBtn"
                data-i18n="back"
                onclick="App.goHome()"
                style="display: none;">
            </button>
            <span id="breadcrumbText" data-i18n="library"></span>
        </div>

        <!-- Library View -->
        <div id="libraryView" class="library-view">
            <div class="library-header">
                <h1 id="libraryTitle" data-i18n="library"></h1>
            </div>
            <div class="library-grid" id="libraryGrid"></div>
        </div>

        <!-- Video View -->
        <div id="videoView" class="hidden">
            <div class="video-section">

                <div class="video-header">
                    <h1>
                        <span id="appTitle" data-i18n="appTitle"></span>
                        <div id="dubLongPressHint" data-i18n="dubLongPressHint"
                             style="font-size:12px;color:#aaa;margin-top:4px;">
                        </div>
                    </h1>

                    <div class="video-controls">
                        <div class="quick-toggle">
                            <button
                                id="dubToggle"
                                class="sys-toggle"
                                data-i18n-title="dubTitle">
                                <span class="icon">X</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="video-container" id="videoContainer"></div>

                <div class="control-panel" id="controlPanel">
                    <div id="preDubNotice" class="dub-notice" data-i18n="preDubNotice"></div>

                    <div id="dubControls" class="control-buttons hidden">
                        <!-- Backward Controls -->
                        <div class="control-btn-group">
                            <button class="control-btn control-btn-small" onclick="DubEngine.adjustTime(-1.5)" aria-label="backward 1.5s">
                                &lt;
                            </button>
                            <span class="btn-label">1.5s</span>
                        </div>

                        <div class="control-btn-group">
                            <button class="control-btn" onclick="DubEngine.adjustTime(-1)" aria-label="backward 1s">
                                &lt;
                            </button>
                            <span class="btn-label">1s</span>
                        </div>

                        <!-- Forward Controls -->
                        <div class="control-btn-group">
                            <button class="control-btn" onclick="DubEngine.adjustTime(1)" aria-label="forward 1s">
                                &gt;
                            </button>
                            <span class="btn-label">1s</span>
                        </div>

                        <div class="control-btn-group">
                            <button class="control-btn control-btn-small" onclick="DubEngine.adjustTime(1.5)" aria-label="forward 1.5s">
                                &gt;
                            </button>
                            <span class="btn-label">1.5s</span>
                        </div>
                    </div>
                </div>

                <div class="dub-selector" id="dubSelector" style="display: none;">
                    <h3 id="dubTitle" data-i18n="dubTitle"></h3>
                    <div class="dub-buttons" id="dubButtons"></div>

                    <div class="dub-status-indicator" id="dubStatusIndicator">
                        <span id="statusText"></span>
                    </div>
                </div>

                <div class="video-info">
                    <h2 class="video-title" id="videoTitle"></h2>
                    <p class="video-description" id="videoDescription"></p>
                </div>
            </div>

            <!-- Comments -->
            <div class="comments-section">
                <div class="comments-header">
                    <h2>
                        <span class="comments-update-indicator paused" id="updateIndicator"></span>
                        <span id="commentsTitle" data-i18n="comments"></span>
                    </h2>
                    <span
                        class="comments-count"
                        id="commentsCount"
                        data-i18n="commentCount"
                        data-i18n-count="0">
                    </span>
                </div>

                <div class="status-message" id="statusMessage"></div>

                <div class="comment-form">
                    <form id="commentForm">
                        <div class="form-group">
                            <label for="commentName" id="labelName" data-i18n="labelName"></label>
                            <input
                                type="text"
                                id="commentName"
                                maxlength="50"
                                data-i18n-placeholder="placeholderName">
                            <div class="form-hint" id="hintName" data-i18n="hintName"></div>
                        </div>

                        <div class="form-group">
                            <label for="commentText" id="labelComment" data-i18n="labelComment"></label>
                            <textarea
                                id="commentText"
                                required
                                maxlength="500"
                                data-i18n-placeholder="placeholderComment">
                            </textarea>
                        </div>

                        <button
                            type="submit"
                            class="submit-btn"
                            id="submitBtn"
                            data-i18n="submit">
                        </button>
                    </form>
                </div>

                <div id="commentsListContainer">
                    <div class="loading" id="loadingText" data-i18n="loading"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3 data-i18n="footerAbout"></h3>
                <p data-i18n="footerAboutText"></p>
            </div>
            <div class="footer-section">
                <h3 data-i18n="footerLinks"></h3>
                <a href="#" onclick="Modal.showPrivacy(); return false;" data-i18n="privacyPolicy"></a>
                <a href="#" onclick="Modal.showTerms(); return false;" data-i18n="termsOfService"></a>
            </div>
            <div class="footer-section">
                <h3 data-i18n="footerContact"></h3>
                <p data-i18n="footerContactText"></p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 <span data-i18n="appTitle"></span>. <span data-i18n="footerRights"></span></p>
        </div>
    </footer>

    <!-- Language Switch -->
    <div id="langToggle" data-i18n-title="langButtonLabel">ğŸŒ</div>

    <div id="langMenu" class="hidden">
        <button data-lang="ar" data-i18n="langAr"></button>
        <button data-lang="en" data-i18n="langEn"></button>
        <button data-lang="fr" data-i18n="langFr"></button>
        <button data-lang="ja" data-i18n="langJa"></button>
    </div>

    <!-- Modal Container -->
    <div id="modalContainer"></div>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/i18next/23.7.6/i18next.min.js"></script>
    
    <script>
// ============================================
// GLOBAL STATE & CONFIGURATION
// ============================================
const CONFIG = {
    BACKEND_URL: 'https://site--watch-vip--j9hb6dlmp4qm.code.run',
    REFRESH_INTERVAL: 10000,
    SUBMIT_COOLDOWN: 3000,
    LONG_PRESS_DURATION: 500,
    SEEK_STEP: 1,
    ADMIN_CLIENT_ID: 'admin_vip_2026'
};

// YouTube API
let YTReady = false;
window.onYouTubeIframeAPIReady = function() {
    YTReady = true;
    console.log('YouTube API Ready');
    DubEngine.setupPlayersWhenReady();
};

// ============================================
// i18next CONFIGURATION
// ============================================
const i18nResources = {
    ar: {
        translation: {
            library: 'Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª',
            back: 'Ø§Ù„Ø±Ø¬ÙˆØ¹',
            comments: 'Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª',
            commentCount: '{{count}} ØªØ¹Ù„ÙŠÙ‚',
            commentCount_plural: '{{count}} ØªØ¹Ù„ÙŠÙ‚',
            labelName: 'Ø§Ù„Ø§Ø³Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)',
            hintName: 'Ø³ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ø³Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¥Ù† Ù„Ù… ØªÙƒØªØ¨',
            labelComment: 'Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ *',
            placeholderName: 'Ø§ØªØ±Ùƒ ÙØ§Ø±ØºØ§Ù‹ Ù„Ù„ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ',
            placeholderComment: 'Ø´Ø§Ø±Ùƒ Ø±Ø£ÙŠÙƒ...',
            submit: 'Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚',
            submitting: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„',
            noComments: 'Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†',
            loading: 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„',
            pending: 'Ù„Ø¯ÙŠÙƒ ØªØ¹Ù„ÙŠÙ‚ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',
            empty: 'Ø£ÙƒÙ…Ù„ ÙƒØªØ§Ø¨Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚',
            success: 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ø¨Ù†Ø¬Ø§Ø­',
            error: 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„',
            canComment: 'ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ù…Ø¬Ø¯Ø¯Ø§Ù‹',
            rateLimitError: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„',
            langButtonLabel: 'ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ©',
            dubTitle: 'Ø§Ø®ØªØ± Ù†Ø³Ø®Ø© Ø§Ù„Ø¹Ø±Ø¶',
            dubHint: 'Ø§Ù†Ù‚Ø± Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ØŒ Ø§Ø¶ØºØ· Ø·ÙˆÙŠÙ„Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©',
            episodeCount: '{{count}} Ø­Ù„Ù‚Ø©',
            episodeCount_plural: '{{count}} Ø­Ù„Ù‚Ø©',
            statusOriginal: 'Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ù‚ÙŠØ¯ Ø§Ù„ØªØ´ØºÙŠÙ„',
            statusArabic: 'Ø§Ù„Ø¯Ø¨Ù„Ø¬Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù…ÙØ¹Ù„Ø©',
            statusJapanese: 'Ø§Ù„Ø¯Ø¨Ù„Ø¬Ø© Ø§Ù„ÙŠØ§Ø¨Ø§Ù†ÙŠØ© Ù…ÙØ¹Ù„Ø©',
            appTitle: 'Watch VIP',
            dubLongPressHint: 'Ø§Ø¶ØºØ· Ù…Ø·ÙˆÙ‘Ù„Ù‹Ø§ Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¯Ø¨Ù„Ø¬Ø© Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¯Ø¨Ù„Ø¬Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©',
            preDubNotice: 'Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ù„Ø¶Ø¨Ø· Ø§Ù„ØªÙˆÙ‚ÙŠØª ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø©',
            justNow: 'Ù„Ù„ØªÙˆ',
            minutesAgo: 'Ù…Ù†Ø° {{count}} Ø¯Ù‚ÙŠÙ‚Ø©',
            hoursAgo: 'Ù…Ù†Ø° {{count}} Ø³Ø§Ø¹Ø©',
            daysAgo: 'Ù…Ù†Ø° {{count}} ÙŠÙˆÙ…',
            original: 'Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©',
            metaDescription: 'Ù…Ù†ØµØ© Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª Ù…Ø¹ Ø¯Ø¨Ù„Ø¬Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ù„ØºØ§Øª',
            arabicDub: 'Ø¯Ø¨Ù„Ø¬Ø© Ø¹Ø±Ø¨ÙŠØ©',
            japaneseDub: 'Ø¯Ø¨Ù„Ø¬Ø© ÙŠØ§Ø¨Ø§Ù†ÙŠØ©',
            langAr: 'Ø¹Ø±Ø¨ÙŠ',
            langEn: 'English',
            langFr: 'FranÃ§ais',
            langJa: 'æ—¥æœ¬èª',
            'series.doraemon.title': 'Ø¯ÙˆØ±Ø§ÙŠÙ…ÙˆÙ†',
            'series.doraemon.episode.ep01.title': 'Ø§Ù„Ø­Ù„Ù‚Ø© 01 - Ø¨Ø¯Ø§ÙŠØ© Ø¯ÙˆØ±Ø§ÙŠÙ…ÙˆÙ†',
            'series.doraemon.episode.ep01.description': 'Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø£Ø­Ù„Ø§Ù… â€“ Ø£Ø±Ø¶ Ù†ÙˆØ¨ÙŠØªØ§',
            footerAbout: 'Ø¹Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹',
            footerAboutText: 'Ù…Ù†ØµØ© Watch VIP ØªÙˆÙØ± Ù„Ùƒ Ø£ÙØ¶Ù„ ØªØ¬Ø±Ø¨Ø© Ù…Ø´Ø§Ù‡Ø¯Ø© Ù„Ù„Ù…Ø³Ù„Ø³Ù„Ø§Øª Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„Ø¯Ø¨Ù„Ø¬Ø© Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©.',
            footerLinks: 'Ø±ÙˆØ§Ø¨Ø· Ù…Ù‡Ù…Ø©',
            footerContact: 'ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§',
            footerContactText: 'Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª ÙˆØ§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠØŒ ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.',
            footerRights: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©',
            privacyPolicy: 'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©',
            termsOfService: 'Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…',
            adminBadge: 'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„'
        }
    },
    en: {
        translation: {
            library: 'Series',
            back: 'Back',
            comments: 'Comments',
            commentCount: '{{count}} comment',
            commentCount_plural: '{{count}} comments',
            labelName: 'Name (Optional)',
            hintName: 'An automatic name will be generated if left blank',
            labelComment: 'Comment *',
            placeholderName: 'Leave blank for auto-generation',
            placeholderComment: 'Share your thoughts...',
            submit: 'Post Comment',
            submitting: 'Posting',
            noComments: 'No comments yet',
            loading: 'Loading',
            pending: 'Your comment is under review',
            empty: 'Please write a comment',
            success: 'Comment posted successfully',
            error: 'Failed to send comment',
            canComment: 'You can comment again',
            rateLimitError: 'Please wait a moment before posting',
            langButtonLabel: 'Change Language',
            dubTitle: 'Choose Version',
            dubHint: 'Click to toggle, long press to show menu',
            episodeCount: '{{count}} episode',
            episodeCount_plural: '{{count}} episodes',
            statusOriginal: 'Original version is playing',
            statusArabic: 'Arabic dub is enabled',
            statusJapanese: 'Japanese dub is enabled',
            appTitle: 'Watch VIP',
            dubLongPressHint: 'Long press the dub button to select the appropriate dubbing',
            preDubNotice: 'Use the control buttons to manually adjust timing as needed',
            justNow: 'just now',
            minutesAgo: '{{count}}m ago',
            hoursAgo: '{{count}}h ago',
            daysAgo: '{{count}}d ago',
            original: 'Original Version',
            metaDescription: 'Watch series with multi-language dubbing',
            arabicDub: 'Arabic Dub',
            japaneseDub: 'Japanese Dub',
            langAr: 'Ø¹Ø±Ø¨ÙŠ',
            langEn: 'English',
            langFr: 'FranÃ§ais',
            langJa: 'æ—¥æœ¬èª',
            'series.doraemon.title': 'Doraemon',
            'series.doraemon.episode.ep01.title': 'Episode 01 - The Beginning of Doraemon',
            'series.doraemon.episode.ep01.description': 'Dream City - Nobita\'s Land',
            footerAbout: 'About',
            footerAboutText: 'Watch VIP provides the best series watching experience with multi-language dubbing.',
            footerLinks: 'Important Links',
            footerContact: 'Contact Us',
            footerContactText: 'For inquiries and technical support, contact us via email.',
            footerRights: 'All Rights Reserved',
            privacyPolicy: 'Privacy Policy',
            termsOfService: 'Terms of Service',
            adminBadge: 'Admin'
        }
    },
    fr: {
        translation: {
            library: 'SÃ©ries',
            back: 'Retour',
            comments: 'Commentaires',
            commentCount: '{{count}} commentaire',
            commentCount_plural: '{{count}} commentaires',
            labelName: 'Nom (Optionnel)',
            hintName: 'Un nom automatique sera gÃ©nÃ©rÃ© si laissÃ© vide',
            labelComment: 'Commentaire *',
            placeholderName: 'Laisser vide pour la gÃ©nÃ©ration automatique',
            placeholderComment: 'Partagez vos pensÃ©es...',
            submit: 'Publier le commentaire',
            submitting: 'Publication',
            noComments: 'Pas encore de commentaires',
            loading: 'Chargement',
            pending: 'Votre commentaire est en attente d\'approbation',
            empty: 'Veuillez Ã©crire un commentaire',
            success: 'Commentaire publiÃ© avec succÃ¨s',
            error: 'Erreur lors de l\'envoi',
            canComment: 'Vous pouvez commenter Ã  nouveau',
            rateLimitError: 'Veuillez attendre un moment avant de publier',
            langButtonLabel: 'Changer la Langue',
            dubTitle: 'Choisir la version',
            dubHint: 'Cliquez pour basculer, appuyez longuement pour le menu',
            episodeCount: '{{count}} Ã©pisode',
            episodeCount_plural: '{{count}} Ã©pisodes',
            statusOriginal: 'La version originale est en cours de lecture',
            statusArabic: 'Le doublage arabe est activÃ©',
            statusJapanese: 'Le doublage japonais est activÃ©',
            appTitle: 'Watch VIP',
            dubLongPressHint: 'Appuyez longuement sur le bouton de doublage pour sÃ©lectionner le doublage appropriÃ©',
            preDubNotice: 'Utilisez les boutons de contrÃ´le pour ajuster manuellement le timing selon les besoins',
            justNow: 'Ã  l\'instant',
            minutesAgo: 'il y a {{count}}m',
            hoursAgo: 'il y a {{count}}h',
            daysAgo: 'il y a {{count}}j',
            original: 'Version Originale',
            metaDescription: 'Regardez des sÃ©ries avec doublage multilingue',
            arabicDub: 'Doublage Arabe',
            japaneseDub: 'Doublage Japonais',
            langAr: 'Ø¹Ø±Ø¨ÙŠ',
            langEn: 'English',
            langFr: 'FranÃ§ais',
            langJa: 'æ—¥æœ¬èª',
            'series.doraemon.title': 'Doraemon',
            'series.doraemon.episode.ep01.title': 'Ã‰pisode 01 - Le DÃ©but de Doraemon',
            'series.doraemon.episode.ep01.description': 'Ville des RÃªves - Terre de Nobita',
            footerAbout: 'Ã€ propos',
            footerAboutText: 'Watch VIP offre la meilleure expÃ©rience de visionnage de sÃ©ries avec doublage multilingue.',
            footerLinks: 'Liens Importants',
            footerContact: 'Nous Contacter',
            footerContactText: 'Pour toute question ou support technique, contactez-nous par email.',
            footerRights: 'Tous Droits RÃ©servÃ©s',
            privacyPolicy: 'Politique de ConfidentialitÃ©',
            termsOfService: 'Conditions d\'Utilisation',
            adminBadge: 'Administrateur'
        }
    },
    ja: {
        translation: {
            library: 'ã‚·ãƒªãƒ¼ã‚º',
            back: 'æˆ»ã‚‹',
            comments: 'ã‚³ãƒ¡ãƒ³ãƒˆ',
            commentCount: '{{count}}ã‚³ãƒ¡ãƒ³ãƒˆ',
            commentCount_plural: '{{count}}ã‚³ãƒ¡ãƒ³ãƒˆ',
            labelName: 'åå‰ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)',
            hintName: 'ç©ºç™½ã®ã¾ã¾ã«ã™ã‚‹ã¨ãƒ©ãƒ³ãƒ€ãƒ ã«ç”Ÿæˆã•ã‚Œã¾ã™',
            labelComment: 'ã‚³ãƒ¡ãƒ³ãƒˆ *',
            placeholderName: 'è‡ªå‹•ç”Ÿæˆã®ãŸã‚ç©ºç™½ã®ã¾ã¾ã«ã—ã¦ãã ã•ã„',
            placeholderComment: 'ã‚ãªãŸã®è€ƒãˆã‚’å…±æœ‰ã—ã¦ãã ã•ã„...',
            submit: 'ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿',
            submitting: 'æŠ•ç¨¿ä¸­',
            noComments: 'ã¾ã ã‚³ãƒ¡ãƒ³ãƒˆãŒã‚ã‚Šã¾ã›ã‚“',
            loading: 'èª­ã¿è¾¼ã¿ä¸­',
            pending: 'ã‚³ãƒ¡ãƒ³ãƒˆã¯å¯©æŸ»ä¸­ã§ã™',
            empty: 'ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
            success: 'ã‚³ãƒ¡ãƒ³ãƒˆãŒæ­£å¸¸ã«æŠ•ç¨¿ã•ã‚Œã¾ã—ãŸ',
            error: 'é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ',
            canComment: 'ã‚‚ã†ä¸€åº¦ã‚³ãƒ¡ãƒ³ãƒˆã§ãã¾ã™',
            rateLimitError: 'æŠ•ç¨¿ã™ã‚‹å‰ã«ãŠå¾…ã¡ãã ã•ã„',
            langButtonLabel: 'è¨€èªã‚’å¤‰æ›´',
            dubTitle: 'ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’é¸æŠ',
            dubHint: 'ã‚¯ãƒªãƒƒã‚¯ã—ã¦åˆ‡ã‚Šæ›¿ãˆã€é•·æŠ¼ã—ã—ã¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¡¨ç¤º',
            episodeCount: '{{count}}ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰',
            episodeCount_plural: '{{count}}ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰',
            statusOriginal: 'ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå†ç”Ÿä¸­',
            statusArabic: 'ã‚¢ãƒ©ãƒ“ã‚¢èªå¹ãæ›¿ãˆãŒæœ‰åŠ¹',
            statusJapanese: 'æ—¥æœ¬èªå¹ãæ›¿ãˆãŒæœ‰åŠ¹',
            appTitle: 'Watch VIP',
            dubLongPressHint: 'å¹ãæ›¿ãˆãƒœã‚¿ãƒ³ã‚’é•·æŠ¼ã—ã—ã¦é©åˆ‡ãªå¹ãæ›¿ãˆã‚’é¸æŠã—ã¦ãã ã•ã„',
            preDubNotice: 'å¿…è¦ã«å¿œã˜ã¦ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦æ‰‹å‹•ã§ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’èª¿æ•´ã—ã¦ãã ã•ã„',
            justNow: 'ä»Š',
            minutesAgo: '{{count}}åˆ†å‰',
            hoursAgo: '{{count}}æ™‚é–“å‰',
            daysAgo: '{{count}}æ—¥å‰',
            original: 'ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³',
            metaDescription: 'å¤šè¨€èªå¹ãæ›¿ãˆã§ã‚·ãƒªãƒ¼ã‚ºã‚’è¦–è´',
            arabicDub: 'ã‚¢ãƒ©ãƒ“ã‚¢èªå¹ãæ›¿ãˆ',
            japaneseDub: 'æ—¥æœ¬èªå¹ãæ›¿ãˆ',
            langAr: 'Ø¹Ø±Ø¨ÙŠ',
            langEn: 'English',
            langFr: 'FranÃ§ais',
            langJa: 'æ—¥æœ¬èª',
            'series.doraemon.title': 'ãƒ‰ãƒ©ãˆã‚‚ã‚“',
            'series.doraemon.episode.ep01.title': 'ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰01 - ãƒ‰ãƒ©ãˆã‚‚ã‚“ã®å§‹ã¾ã‚Š',
            'series.doraemon.episode.ep01.description': 'ãƒ‰ãƒªãƒ¼ãƒ ã‚·ãƒ†ã‚£ - ã®ã³å¤ªã®å›½',
            footerAbout: 'æ¦‚è¦',
            footerAboutText: 'Watch VIPã¯å¤šè¨€èªå¹ãæ›¿ãˆã§æœ€é«˜ã®ã‚·ãƒªãƒ¼ã‚ºè¦–è´ä½“é¨“ã‚’æä¾›ã—ã¾ã™ã€‚',
            footerLinks: 'é‡è¦ãªãƒªãƒ³ã‚¯',
            footerContact: 'ãŠå•ã„åˆã‚ã›',
            footerContactText: 'ãŠå•ã„åˆã‚ã›ã‚„æŠ€è¡“ã‚µãƒãƒ¼ãƒˆã¯ã€ãƒ¡ãƒ¼ãƒ«ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚',
            footerRights: 'å…¨è‘—ä½œæ¨©æ‰€æœ‰',
            privacyPolicy: 'ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼',
            termsOfService: 'åˆ©ç”¨è¦ç´„',
            adminBadge: 'ç®¡ç†è€…'
        }
    }
};

// ============================================
// DATA
// ============================================
const LIBRARY = {
    series: [
        {
            id: 'doraemon',
            titleKey: 'series.doraemon.title',
            cover: 'covers/doraemon.jpg',
            episodes: [
                {
                    id: 'ep01',
                    titleKey: 'series.doraemon.episode.ep01.title',
                    descriptionKey: 'series.doraemon.episode.ep01.description',
                    cover: 'covers/ep01.jpg',
                    versions: {
                        original: {
                            nameKey: 'original',
                            icon: '&#9658;',
                            id: 'ZYycK1Paq4M'
                        },
                        arabic: {
                            nameKey: 'arabicDub',
                            icon: '&#128266;',
                            id: 'B_Ha4vu-qc8'
                        },
                        japanese: {
                            nameKey: 'japaneseDub',
                            icon: '&#12289;&#12289;',
                            id: 'xYJpOiuPohQ'
                        }
                    }
                }
            ]
        }
    ]
};

// ============================================
// MODAL MANAGER
// ============================================
const Modal = {
    show(title, content) {
        const container = document.getElementById('modalContainer');
        if (!container) return;

        container.innerHTML = `
            <div class="modal-overlay" onclick="Modal.close(event)">
                <div class="modal-content" onclick="event.stopPropagation()">
                    <div class="modal-header">
                        <h2>${title}</h2>
                        <button class="modal-close" onclick="Modal.close()">&times;</button>
                    </div>
                    <div class="modal-body">
                        ${content}
                    </div>
                </div>
            </div>
        `;

        document.body.style.overflow = 'hidden';
    },

    close(event) {
        if (event && event.target.className !== 'modal-overlay') return;
        
        const container = document.getElementById('modalContainer');
        if (container) {
            container.innerHTML = '';
        }
        document.body.style.overflow = '';
    },

    showPrivacy() {
        const lang = i18next.language;
        let content = '';

        if (lang === 'ar') {
            content = `
                <h3>ğŸ”’ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</h3>
                <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³Ø±ÙŠØ§Ù†:</strong> 16 ÙŠÙ†Ø§ÙŠØ± 2026</p>

                <h3>1. Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙŠ Ù†Ø¬Ù…Ø¹Ù‡Ø§</h3>
                <p>Ù†Ø­Ù† ÙÙŠ Watch VIP Ù†Ø­ØªØ±Ù… Ø®ØµÙˆØµÙŠØªÙƒ ÙˆÙ†Ù„ØªØ²Ù… Ø¨Ø­Ù…Ø§ÙŠØ© Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©. Ù†Ø¬Ù…Ø¹ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:</p>
                <ul>
                    <li><strong>Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· (Cookies):</strong> Ù†Ø³ØªØ®Ø¯Ù… Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ù„ØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ø¨Ø± Google Analytics.</li>
                    <li><strong>Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª:</strong> Ø¹Ù†Ø¯ ÙƒØªØ§Ø¨Ø© ØªØ¹Ù„ÙŠÙ‚ØŒ Ù†Ù‚ÙˆÙ… Ø¨ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø§Ø³Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) ÙˆØ§Ù„Ù†Øµ ÙˆØ§Ù„Ù…Ø¹Ø±Ù Ø§Ù„ÙØ±ÙŠØ¯ Ù„Ù„Ù…ØªØµÙØ­ (Client ID).</li>
                    <li><strong>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØµÙØ­:</strong> Ù†Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¬Ù‡ÙˆÙ„Ø© Ø­ÙˆÙ„ ÙƒÙŠÙÙŠØ© Ø§Ø³ØªØ®Ø¯Ø§Ù…Ùƒ Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø®Ø¯Ù…Ø©.</li>
                </ul>

                <h3>2. Ø§Ø³ØªØ®Ø¯Ø§Ù… Google Analytics Ùˆ Google AdSense</h3>
                <ul>
                    <li><strong>Google Analytics:</strong> Ù†Ø³ØªØ®Ø¯Ù… Google Analytics Ù„ØªØ­Ù„ÙŠÙ„ Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø±ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹. ÙŠØªÙ… Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø´ÙƒÙ„ Ù…Ø¬Ù‡ÙˆÙ„ ÙˆÙ„Ø§ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø´Ø®ØµÙŠØ© Ù…Ø­Ø¯Ø¯Ø©.</li>
                    <li><strong>Google AdSense:</strong> Ù‚Ø¯ Ù†Ø¹Ø±Ø¶ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ù† Google AdSense. Ù‚Ø¯ ØªØ³ØªØ®Ø¯Ù… Google Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ù„Ø¹Ø±Ø¶ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ø®ØµØµØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø²ÙŠØ§Ø±Ø§ØªÙƒ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©.</li>
                </ul>

                <h3>3. YouTube ÙˆØ³ÙŠØ§Ø³Ø© COPPA</h3>
                <p>Ù†Ø³ØªØ®Ø¯Ù… YouTube API Services Ù„Ø¹Ø±Ø¶ Ù…Ù‚Ø§Ø·Ø¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ø¹Ø§Ø¦Ù„Ø© ÙˆØªØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ù‚ÙˆØ§Ù†ÙŠÙ† Ø­Ù…Ø§ÙŠØ© Ø®ØµÙˆØµÙŠØ© Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª (COPPA).</p>
                <ul>
                    <li>Ù„Ø§ Ù†Ø¬Ù…Ø¹ Ø¹Ù…Ø¯Ø§Ù‹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø´Ø®ØµÙŠØ© Ù…Ù† Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø¯ÙˆÙ† Ø³Ù† 13 Ø¹Ø§Ù…Ø§Ù‹.</li>
                    <li>Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶ Ø¢Ù…Ù† ÙˆØ®Ø§Ù„Ù Ù…Ù† Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ØºÙŠØ± Ø§Ù„Ù„Ø§Ø¦Ù‚.</li>
                    <li>Ù†ÙˆØµÙŠ Ø¨Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ† Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ø·ÙØ§Ù„ Ù„Ù„Ù…ÙˆÙ‚Ø¹.</li>
                </ul>

                <h3>4. Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø©</h3>
                <ul>
                    <li>ÙŠØªÙ… ØªØ®Ø²ÙŠÙ† Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª PostgreSQL Ø¢Ù…Ù†Ø©.</li>
                    <li>Ù†Ø³ØªØ®Ø¯Ù… Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯ Ù„Ù„Ù…ØªØµÙØ­ (Client ID) Ù„Ù…Ù†Ø¹ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø© - Ù„Ø§ ÙŠØªÙ… Ø±Ø¨Ø·Ù‡ Ø¨Ù‡ÙˆÙŠØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©.</li>
                    <li>ÙŠÙ…ÙƒÙ†Ùƒ Ø­Ø°Ù ØªØ¹Ù„ÙŠÙ‚Ùƒ Ø¨Ø§Ù„Ù†Ù‚Ø± Ù…Ø±ØªÙŠÙ† Ø¹Ù„ÙŠÙ‡.</li>
                </ul>

                <h3>5. Ø­Ù‚ÙˆÙ‚Ùƒ</h3>
                <ul>
                    <li>ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø·ÙŠÙ„ Ù…Ù„ÙØ§Øª ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø±ØªØ¨Ø§Ø· Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØµÙØ­.</li>
                    <li>ÙŠÙ…ÙƒÙ†Ùƒ Ø·Ù„Ø¨ Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª.</li>
                    <li>ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ© Ø¹Ø¨Ø± <a href="https://www.google.com/settings/ads" target="_blank">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Google</a>.</li>
                </ul>

                <div class="highlight-box">
                    <p><strong>âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù‡Ù…Ø©:</strong> Ù†Ø­Ù† Ù„Ø§ Ù†Ø¨ÙŠØ¹ Ø£Ùˆ Ù†Ø´Ø§Ø±Ùƒ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© Ù…Ø¹ Ø£Ø·Ø±Ø§Ù Ø«Ø§Ù„Ø«Ø© Ø¨Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ© Ù…Ø«Ù„ Google Analytics Ùˆ YouTube.</p>
                </div>

                <h3>6. Ø§Ù„Ø§ØªØµØ§Ù„</h3>
                <p>Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ Ø£ÙŠ Ø£Ø³Ø¦Ù„Ø© Ø­ÙˆÙ„ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.</p>
            `;
        } else if (lang === 'en') {
            content = `
                <h3>ğŸ”’ Privacy Policy</h3>
                <p><strong>Effective Date:</strong> January 16, 2026</p>

                <h3>1. Information We Collect</h3>
                <p>At Watch VIP, we respect your privacy and are committed to protecting your personal data. We collect the following information:</p>
                <ul>
                    <li><strong>Cookies:</strong> We use cookies to improve user experience and analyze site usage via Google Analytics.</li>
                    <li><strong>Comments:</strong> When you post a comment, we store your name (optional), text, and unique browser identifier (Client ID).</li>
                    <li><strong>Browsing Data:</strong> We collect anonymous data about how you use the site to improve our service.</li>
                </ul>

                <h3>2. Use of Google Analytics & Google AdSense</h3>
                <ul>
                    <li><strong>Google Analytics:</strong> We use Google Analytics to analyze site traffic. Data is collected anonymously and does not contain specific personal information.</li>
                    <li><strong>Google AdSense:</strong> We may display ads from Google AdSense. Google may use cookies to show personalized ads based on your previous visits.</li>
                </ul>

                <h3>3. YouTube & COPPA Policy</h3>
                <p>We use YouTube API Services to display videos. All content displayed is family-friendly and complies with the Children's Online Privacy Protection Act (COPPA).</p>
                <ul>
                    <li>We do not knowingly collect personal information from children under 13.</li>
                    <li>Content displayed is safe and free from inappropriate material.</li>
                    <li>We recommend parental supervision for children's use of the site.</li>
                </ul>

                <h3>4. Comments & Stored Data</h3>
                <ul>
                    <li>Comments are stored in a secure PostgreSQL database.</li>
                    <li>We use a unique browser identifier (Client ID) to prevent duplicate comments - it is not linked to your personal identity.</li>
                    <li>You can delete your comment by double-clicking it.</li>
                </ul>

                <h3>5. Your Rights</h3>
                <ul>
                    <li>You can disable cookies from your browser settings.</li>
                    <li>You can request deletion of your data at any time.</li>
                    <li>You can opt out of personalized ads via <a href="https://www.google.com/settings/ads" target="_blank">Google Ads Settings</a>.</li>
                </ul>

                <div class="highlight-box">
                    <p><strong>âš ï¸ Important Note:</strong> We do not sell or share your personal data with third parties except for necessary services like Google Analytics and YouTube.</p>
                </div>

                <h3>6. Contact</h3>
                <p>If you have any questions about our privacy policy, please contact us via email.</p>
            `;
        } else if (lang === 'fr') {
            content = `
                <h3>ğŸ”’ Politique de ConfidentialitÃ©</h3>
                <p><strong>Date d'entrÃ©e en vigueur:</strong> 16 janvier 2026</p>

                <h3>1. Informations que nous collectons</h3>
                <p>Chez Watch VIP, nous respectons votre vie privÃ©e et nous nous engageons Ã  protÃ©ger vos donnÃ©es personnelles. Nous collectons les informations suivantes:</p>
                <ul>
                    <li><strong>Cookies:</strong> Nous utilisons des cookies pour amÃ©liorer l'expÃ©rience utilisateur et analyser l'utilisation du site via Google Analytics.</li>
                    <li><strong>Commentaires:</strong> Lorsque vous publiez un commentaire, nous stockons votre nom (facultatif), votre texte et votre identifiant de navigateur unique (Client ID).</li>
                    <li><strong>DonnÃ©es de navigation:</strong> Nous collectons des donnÃ©es anonymes sur la faÃ§on dont vous utilisez le site pour amÃ©liorer notre service.</li>
                </ul>

                <h3>2. Utilisation de Google Analytics et Google AdSense</h3>
                <ul>
                    <li><strong>Google Analytics:</strong> Nous utilisons Google Analytics pour analyser le trafic du site. Les donnÃ©es sont collectÃ©es de maniÃ¨re anonyme et ne contiennent pas d'informations personnelles spÃ©cifiques.</li>
                    <li><strong>Google AdSense:</strong> Nous pouvons afficher des publicitÃ©s de Google AdSense. Google peut utiliser des cookies pour afficher des publicitÃ©s personnalisÃ©es en fonction de vos visites prÃ©cÃ©dentes.</li>
                </ul>

                <h3>3. YouTube et politique COPPA</h3>
                <p>Nous utilisons les services API YouTube pour afficher des vidÃ©os. Tout le contenu affichÃ© est adaptÃ© aux familles et conforme Ã  la loi sur la protection de la vie privÃ©e des enfants en ligne (COPPA).</p>
                <ul>
                    <li>Nous ne collectons pas sciemment d'informations personnelles d'enfants de moins de 13 ans.</li>
                    <li>Le contenu affichÃ© est sÃ»r et exempt de matÃ©riel inappropriÃ©.</li>
                    <li>Nous recommandons la surveillance parentale pour l'utilisation du site par les enfants.</li>
                </ul>

                <h3>4. Commentaires et donnÃ©es stockÃ©es</h3>
                <ul>
                    <li>Les commentaires sont stockÃ©s dans une base de donnÃ©es PostgreSQL sÃ©curisÃ©e.</li>
                    <li>Nous utilisons un identifiant de navigateur unique (Client ID) pour empÃªcher les commentaires en double - il n'est pas liÃ© Ã  votre identitÃ© personnelle.</li>
                    <li>Vous pouvez supprimer votre commentaire en double-cliquant dessus.</li>
                </ul>

                <h3>5. Vos droits</h3>
                <ul>
                    <li>Vous pouvez dÃ©sactiver les cookies depuis les paramÃ¨tres de votre navigateur.</li>
                    <li>Vous pouvez demander la suppression de vos donnÃ©es Ã  tout moment.</li>
                    <li>Vous pouvez vous dÃ©sabonner des publicitÃ©s personnalisÃ©es via les <a href="https://www.google.com/settings/ads" target="_blank">paramÃ¨tres des annonces Google</a>.</li>
                </ul>

                <div class="highlight-box">
                    <p><strong>âš ï¸ Note importante:</strong> Nous ne vendons ni ne partageons vos donnÃ©es personnelles avec des tiers, sauf pour les services nÃ©cessaires comme Google Analytics et YouTube.</p>
                </div>

                <h3>6. Contact</h3>
                <p>Si vous avez des questions sur notre politique de confidentialitÃ©, veuillez nous contacter par email.</p>
            `;
        } else {
            content = `
                <h3>ğŸ”’ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</h3>
                <p><strong>ç™ºåŠ¹æ—¥:</strong> 2026å¹´1æœˆ16æ—¥</p>

                <h3>1. åé›†ã™ã‚‹æƒ…å ±</h3>
                <p>Watch VIPã§ã¯ã€ãŠå®¢æ§˜ã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã‚’å°Šé‡ã—ã€å€‹äººãƒ‡ãƒ¼ã‚¿ã®ä¿è­·ã«åŠªã‚ã¦ã„ã¾ã™ã€‚æ¬¡ã®æƒ…å ±ã‚’åé›†ã—ã¾ã™:</p>
                <ul>
                    <li><strong>Cookie:</strong> ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã‚’å‘ä¸Šã•ã›ã€Google Analyticsã‚’é€šã˜ã¦ã‚µã‚¤ãƒˆã®ä½¿ç”¨çŠ¶æ³ã‚’åˆ†æã™ã‚‹ãŸã‚ã«Cookieã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</li>
                    <li><strong>ã‚³ãƒ¡ãƒ³ãƒˆ:</strong> ã‚³ãƒ¡ãƒ³ãƒˆã‚’æŠ•ç¨¿ã™ã‚‹ã¨ã€åå‰ï¼ˆä»»æ„ï¼‰ã€ãƒ†ã‚­ã‚¹ãƒˆã€å›ºæœ‰ã®ãƒ–ãƒ©ã‚¦ã‚¶è­˜åˆ¥å­ï¼ˆClient IDï¼‰ã‚’ä¿å­˜ã—ã¾ã™ã€‚</li>
                    <li><strong>é–²è¦§ãƒ‡ãƒ¼ã‚¿:</strong> ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ”¹å–„ã™ã‚‹ãŸã‚ã«ã€ã‚µã‚¤ãƒˆã®ä½¿ç”¨æ–¹æ³•ã«é–¢ã™ã‚‹åŒ¿åãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã—ã¾ã™ã€‚</li>
                </ul>

                <h3>2. Google Analyticsã¨Google AdSenseã®ä½¿ç”¨</h3>
                <ul>
                    <li><strong>Google Analytics:</strong> ã‚µã‚¤ãƒˆã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’åˆ†æã™ã‚‹ãŸã‚ã«Google Analyticsã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã¯åŒ¿åã§åé›†ã•ã‚Œã€ç‰¹å®šã®å€‹äººæƒ…å ±ã¯å«ã¾ã‚Œã¾ã›ã‚“ã€‚</li>
                    <li><strong>Google AdSense:</strong> Google AdSenseã‹ã‚‰ã®åºƒå‘Šã‚’è¡¨ç¤ºã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚Googleã¯ã€ä»¥å‰ã®è¨ªå•ã«åŸºã¥ã„ã¦ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸåºƒå‘Šã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã«Cookieã‚’ä½¿ç”¨ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</li>
                </ul>

                <h3>3. YouTubeã¨COPPAãƒãƒªã‚·ãƒ¼</h3>
                <p>å‹•ç”»ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã«YouTube APIã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚è¡¨ç¤ºã•ã‚Œã‚‹ã™ã¹ã¦ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯å®¶æ—å‘ã‘ã§ã€å…ç«¥ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·æ³•ï¼ˆCOPPAï¼‰ã«æº–æ‹ ã—ã¦ã„ã¾ã™ã€‚</p>
                <ul>
                    <li>13æ­³æœªæº€ã®å­ä¾›ã‹ã‚‰æ•…æ„ã«å€‹äººæƒ…å ±ã‚’åé›†ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
                    <li>è¡¨ç¤ºã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯å®‰å…¨ã§ã€ä¸é©åˆ‡ãªç´ æã‚’å«ã¿ã¾ã›ã‚“ã€‚</li>
                    <li>å­ä¾›ãŒã‚µã‚¤ãƒˆã‚’ä½¿ç”¨ã™ã‚‹éš›ã¯ã€ä¿è­·è€…ã®ç›£ç£ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚</li>
                </ul>

                <h3>4. ã‚³ãƒ¡ãƒ³ãƒˆã¨ä¿å­˜ãƒ‡ãƒ¼ã‚¿</h3>
                <ul>
                    <li>ã‚³ãƒ¡ãƒ³ãƒˆã¯å®‰å…¨ãªPostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚</li>
                    <li>é‡è¤‡ã‚³ãƒ¡ãƒ³ãƒˆã‚’é˜²ããŸã‚ã«å›ºæœ‰ã®ãƒ–ãƒ©ã‚¦ã‚¶è­˜åˆ¥å­ï¼ˆClient IDï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ - å€‹äººã®IDã«ã¯ãƒªãƒ³ã‚¯ã•ã‚Œã¾ã›ã‚“ã€‚</li>
                    <li>ã‚³ãƒ¡ãƒ³ãƒˆã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨å‰Šé™¤ã§ãã¾ã™ã€‚</li>
                </ul>

                <h3>5. ãŠå®¢æ§˜ã®æ¨©åˆ©</h3>
                <ul>
                    <li>ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã‹ã‚‰Cookieã‚’ç„¡åŠ¹ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</li>
                    <li>ã„ã¤ã§ã‚‚ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ã‚’è¦æ±‚ã§ãã¾ã™ã€‚</li>
                    <li><a href="https://www.google.com/settings/ads" target="_blank">Googleåºƒå‘Šè¨­å®š</a>ã‹ã‚‰ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸåºƒå‘Šã‚’ã‚ªãƒ—ãƒˆã‚¢ã‚¦ãƒˆã§ãã¾ã™ã€‚</li>
                </ul>

                <div class="highlight-box">
                    <p><strong>âš ï¸ é‡è¦ãªæ³¨æ„:</strong> Google Analyticsã‚„YouTubeãªã©ã®å¿…è¦ãªã‚µãƒ¼ãƒ“ã‚¹ã‚’é™¤ãã€ãŠå®¢æ§˜ã®å€‹äººãƒ‡ãƒ¼ã‚¿ã‚’ç¬¬ä¸‰è€…ã«è²©å£²ã¾ãŸã¯å…±æœ‰ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
                </div>

                <h3>6. ãŠå•ã„åˆã‚ã›</h3>
                <p>ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã«ã¤ã„ã¦ã”è³ªå•ãŒã‚ã‚‹å ´åˆã¯ã€ãƒ¡ãƒ¼ãƒ«ã§ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚</p>
            `;
        }

        this.show(I18n.t('privacyPolicy'), content);
    },

    showTerms() {
        const lang = i18next.language;
        let content = '';

        if (lang === 'ar') {
            content = `
                <h3>ğŸ“œ Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h3>
                <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø³Ø±ÙŠØ§Ù†:</strong> 16 ÙŠÙ†Ø§ÙŠØ± 2026</p>

                <h3>1. Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø´Ø±ÙˆØ·</h3>
                <p>Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…Ùƒ Ù„Ù…ÙˆÙ‚Ø¹ Watch VIPØŒ ÙØ¥Ù†Ùƒ ØªÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ù‡. Ø¥Ø°Ø§ ÙƒÙ†Øª Ù„Ø§ ØªÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø±ÙˆØ·ØŒ ÙŠØ±Ø¬Ù‰ Ø¹Ø¯Ù… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹.</p>

                <h3>2. Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹</h3>
                <ul>
                    <li>ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¹Ù…Ø±Ùƒ 13 Ø¹Ø§Ù…Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹.</li>
                    <li>ÙŠØ¬Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù„Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© ÙÙ‚Ø·.</li>
                    <li>ÙŠÙÙ…Ù†Ø¹ Ù†Ø´Ø± Ù…Ø­ØªÙˆÙ‰ Ù…Ø³ÙŠØ¡ Ø£Ùˆ ØºÙŠØ± Ù„Ø§Ø¦Ù‚ Ø£Ùˆ ÙŠÙ†ØªÙ‡Ùƒ Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†.</li>
                </ul>

                <h3>3. Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙˆØ§Ù„Ù…Ù„ÙƒÙŠØ© Ø§Ù„ÙÙƒØ±ÙŠØ©</h3>
                <ul>
                    <li>Ø¬Ù…ÙŠØ¹ Ù…Ù‚Ø§Ø·Ø¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© Ù…Ù…Ù„ÙˆÙƒØ© Ù„Ø£ØµØ­Ø§Ø¨Ù‡Ø§ Ø§Ù„Ø£ØµÙ„ÙŠÙŠÙ† ÙˆÙŠØªÙ… Ø¹Ø±Ø¶Ù‡Ø§ Ø¹Ø¨Ø± YouTube API.</li>
                    <li>Ù†Ø­Ù† Ù„Ø§ Ù†Ø³ØªØ¶ÙŠÙ Ø£ÙŠ Ù…Ø­ØªÙˆÙ‰ ÙÙŠØ¯ÙŠÙˆ Ø¹Ù„Ù‰ Ø®ÙˆØ§Ø¯Ù…Ù†Ø§.</li>
                    <li>Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ¹ØªÙ‚Ø¯ Ø£Ù† Ù…Ø­ØªÙˆÙ‰ Ù…Ø§ ÙŠÙ†ØªÙ‡Ùƒ Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ø·Ø¨Ø¹ ÙˆØ§Ù„Ù†Ø´Ø±ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ ÙÙˆØ±Ø§Ù‹.</li>
                </ul>

                <h3>4. Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª ÙˆØ§Ù„Ø³Ù„ÙˆÙƒ</h3>
                <ul>
                    <li>ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ù…Ø­ØªØ±Ù…Ø© ÙˆØ®Ø§Ù„ÙŠØ© Ù…Ù† Ø§Ù„Ø¥Ø³Ø§Ø¡Ø©.</li>
                    <li>Ù†Ø­ØªÙØ¸ Ø¨Ø§Ù„Ø­Ù‚ ÙÙŠ Ø­Ø°Ù Ø£ÙŠ ØªØ¹Ù„ÙŠÙ‚ ØºÙŠØ± Ù„Ø§Ø¦Ù‚ Ø¯ÙˆÙ† Ø¥Ø´Ø¹Ø§Ø± Ù…Ø³Ø¨Ù‚.</li>
                    <li>ÙŠÙÙ…Ù†Ø¹ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ØºÙŠØ± Ø§Ù„Ù…Ø±ØºÙˆØ¨ ÙÙŠÙ‡Ø§ (Spam) ÙˆØ§Ù„ØªØ±ÙˆÙŠØ¬ Ø§Ù„ØªØ¬Ø§Ø±ÙŠ.</li>
                </ul>

                <h3>5. YouTube API Services</h3>
                <p>Ø§Ø³ØªØ®Ø¯Ø§Ù…Ùƒ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ¹Ù†ÙŠ Ù…ÙˆØ§ÙÙ‚ØªÙƒ Ø¹Ù„Ù‰ <a href="https://www.youtube.com/t/terms" target="_blank">Ø´Ø±ÙˆØ· Ø®Ø¯Ù…Ø© YouTube</a> ÙˆØ³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡Ø§.</p>

                <h3>6. Ø¥Ø®Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©</h3>
                <ul>
                    <li>ÙŠØªÙ… ØªÙˆÙÙŠØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹ "ÙƒÙ…Ø§ Ù‡Ùˆ" Ø¯ÙˆÙ† Ø£ÙŠ Ø¶Ù…Ø§Ù†Ø§Øª.</li>
                    <li>Ù„Ø§ Ù†ØªØ­Ù…Ù„ Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø£ÙŠ Ø£Ø¶Ø±Ø§Ø± Ù‚Ø¯ ØªÙ†ØªØ¬ Ø¹Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹.</li>
                    <li>Ù‚Ø¯ ØªØ­ØªÙˆÙŠ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¹Ù„Ù‰ Ù…Ø­ØªÙˆÙ‰ Ù…Ù† Ø£Ø·Ø±Ø§Ù Ø«Ø§Ù„Ø«Ø© - Ù†Ø­Ù† Ù„Ø³Ù†Ø§ Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† Ø¹Ù† Ù…Ø­ØªÙˆØ§Ù‡Ø§.</li>
                </ul>

                <h3>7. Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ·</h3>
                <p>Ù†Ø­ØªÙØ¸ Ø¨Ø§Ù„Ø­Ù‚ ÙÙŠ ØªØ¹Ø¯ÙŠÙ„ Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª. Ø³ÙŠØªÙ… Ù†Ø´Ø± Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©.</p>

                <div class="highlight-box">
                    <p><strong>âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> Ø§Ø³ØªÙ…Ø±Ø§Ø±Ùƒ ÙÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø¹Ø¯ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª ÙŠØ¹Ù†ÙŠ Ù…ÙˆØ§ÙÙ‚ØªÙƒ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· Ø§Ù„Ù…Ø¹Ø¯Ù„Ø©.</p>
                </div>

                <h3>8. Ø§Ù„Ø§ØªØµØ§Ù„</h3>
                <p>Ù„Ù„Ø£Ø³Ø¦Ù„Ø© Ø­ÙˆÙ„ Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.</p>
            `;
        } else if (lang === 'en') {
            content = `
                <h3>ğŸ“œ Terms of Service</h3>
                <p><strong>Effective Date:</strong> January 16, 2026</p>

                <h3>1. Acceptance of Terms</h3>
                <p>By using Watch VIP, you agree to comply with these Terms of Service. If you do not agree with these terms, please do not use the site.</p>

                <h3>2. Use of the Site</h3>
                <ul>
                    <li>You must be at least 13 years old to use this site.</li>
                    <li>The site must be used for lawful purposes only.</li>
                    <li>Posting offensive, inappropriate content or content that violates others' rights is prohibited.</li>
                </ul>

                <h3>3. Content & Intellectual Property</h3>
                <ul>
                    <li>All videos displayed are owned by their original owners and are shown via YouTube API.</li>
                    <li>We do not host any video content on our servers.</li>
                    <li>If you believe content infringes copyright, please contact us immediately.</li>
                </ul>

                <h3>4. Comments & Conduct</h3>
                <ul>
                    <li>Comments must be respectful and free from abuse.</li>
                    <li>We reserve the right to delete any inappropriate comment without prior notice.</li>
                    <li>Spam and commercial promotion are prohibited.</li>
                </ul>

                <h3>5. YouTube API Services</h3>
                <p>Your use of this site means you agree to <a href="https://www.youtube.com/t/terms" target="_blank">YouTube's Terms of Service</a> and its privacy policy.</p>

                <h3>6. Disclaimer</h3>
                <ul>
                    <li>The site is provided "as is" without any warranties.</li>
                    <li>We are not responsible for any damages that may result from using the site.</li>
                    <li>Ads may contain third-party content - we are not responsible for their content.</li>
                </ul>

                <h3>7. Changes to Terms</h3>
                <p>We reserve the right to modify the Terms of Service at any time. Changes will be posted on this page.</p>

                <div class="highlight-box">
                    <p><strong>âš ï¸ Note:</strong> Your continued use of the site after changes means you agree to the modified terms.</p>
                </div>

                <h3>8. Contact</h3>
                <p>For questions about the Terms of Service, please contact us via email.</p>
            `;
        } else if (lang === 'fr') {
            content = `
                <h3>ğŸ“œ Conditions d'Utilisation</h3>
                <p><strong>Date d'entrÃ©e en vigueur:</strong> 16 janvier 2026</p>

                <h3>1. Acceptation des Conditions</h3>
                <p>En utilisant Watch VIP, vous acceptez de vous conformer Ã  ces Conditions d'Utilisation. Si vous n'Ãªtes pas d'accord avec ces conditions, veuillez ne pas utiliser le site.</p>

                <h3>2. Utilisation du Site</h3>
                <ul>
                    <li>Vous devez avoir au moins 13 ans pour utiliser ce site.</li>
                    <li>Le site doit Ãªtre utilisÃ© Ã  des fins lÃ©gales uniquement.</li>
                    <li>La publication de contenu offensant, inappropriÃ© ou qui viole les droits d'autrui est interdite.</li>
                </ul>

                <h3>3. Contenu et PropriÃ©tÃ© Intellectuelle</h3>
                <ul>
                    <li>Toutes les vidÃ©os affichÃ©es appartiennent Ã  leurs propriÃ©taires d'origine et sont affichÃ©es via l'API YouTube.</li>
                    <li>Nous n'hÃ©bergeons aucun contenu vidÃ©o sur nos serveurs.</li>
                    <li>Si vous pensez qu'un contenu enfreint les droits d'auteur, veuillez nous contacter immÃ©diatement.</li>
                </ul>

                <h3>4. Commentaires et Conduite</h3>
                <ul>
                    <li>Les commentaires doivent Ãªtre respectueux et exempts d'abus.</li>
                    <li>Nous nous rÃ©servons le droit de supprimer tout commentaire inappropriÃ© sans prÃ©avis.</li>
                    <li>Le spam et la promotion commerciale sont interdits.</li>
                </ul>

                <h3>5. Services API YouTube</h3>
                <p>Votre utilisation de ce site signifie que vous acceptez les <a href="https://www.youtube.com/t/terms" target="_blank">Conditions d'utilisation de YouTube</a> et sa politique de confidentialitÃ©.</p>

                <h3>6. Clause de Non-ResponsabilitÃ©</h3>
                <ul>
                    <li>Le site est fourni "tel quel" sans aucune garantie.</li>
                    <li>Nous ne sommes pas responsables des dommages pouvant rÃ©sulter de l'utilisation du site.</li>
                    <li>Les publicitÃ©s peuvent contenir du contenu de tiers - nous ne sommes pas responsables de leur contenu.</li>
                </ul>

                <h3>7. Modifications des Conditions</h3>
                <p>Nous nous rÃ©servons le droit de modifier les Conditions d'Utilisation Ã  tout moment. Les modifications seront publiÃ©es sur cette page.</p>

                <div class="highlight-box">
                    <p><strong>âš ï¸ Note:</strong> Votre utilisation continue du site aprÃ¨s les modifications signifie que vous acceptez les conditions modifiÃ©es.</p>
                </div>

                <h3>8. Contact</h3>
                <p>Pour des questions sur les Conditions d'Utilisation, veuillez nous contacter par email.</p>
            `;
        } else {
            content = `
                <h3>ğŸ“œ åˆ©ç”¨è¦ç´„</h3>
                <p><strong>ç™ºåŠ¹æ—¥:</strong> 2026å¹´1æœˆ16æ—¥</p>

                <h3>1. è¦ç´„ã®æ‰¿èª</h3>
                <p>Watch VIPã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€æœ¬åˆ©ç”¨è¦ç´„ã«å¾“ã†ã“ã¨ã«åŒæ„ã—ãŸã‚‚ã®ã¨ã¿ãªã•ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã®è¦ç´„ã«åŒæ„ã—ãªã„å ´åˆã¯ã€ã‚µã‚¤ãƒˆã‚’ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚</p>

                <h3>2. ã‚µã‚¤ãƒˆã®ä½¿ç”¨</h3>
                <ul>
                    <li>ã“ã®ã‚µã‚¤ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€å°‘ãªãã¨ã‚‚13æ­³ä»¥ä¸Šã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</li>
                    <li>ã‚µã‚¤ãƒˆã¯åˆæ³•çš„ãªç›®çš„ã§ã®ã¿ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</li>
                    <li>æ”»æ’ƒçš„ã€ä¸é©åˆ‡ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã€ã¾ãŸã¯ä»–è€…ã®æ¨©åˆ©ã‚’ä¾µå®³ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®æŠ•ç¨¿ã¯ç¦æ­¢ã•ã‚Œã¦ã„ã¾ã™ã€‚</li>
                </ul>

                <h3>3. ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨çŸ¥çš„è²¡ç”£</h3>
                <ul>
                    <li>è¡¨ç¤ºã•ã‚Œã‚‹ã™ã¹ã¦ã®å‹•ç”»ã¯å…ƒã®æ‰€æœ‰è€…ã«å¸°å±ã—ã€YouTube APIã‚’é€šã˜ã¦è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</li>
                    <li>å½“ç¤¾ã®ã‚µãƒ¼ãƒãƒ¼ã«å‹•ç”»ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒ›ã‚¹ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚</li>
                    <li>ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè‘—ä½œæ¨©ã‚’ä¾µå®³ã—ã¦ã„ã‚‹ã¨æ€ã‚ã‚Œã‚‹å ´åˆã¯ã€ç›´ã¡ã«ã”é€£çµ¡ãã ã•ã„ã€‚</li>
                </ul>

                <h3>4. ã‚³ãƒ¡ãƒ³ãƒˆã¨è¡Œå‹•</h3>
                <ul>
                    <li>ã‚³ãƒ¡ãƒ³ãƒˆã¯æ•¬æ„ã‚’æŒã¡ã€è™å¾…ã®ãªã„ã‚‚ã®ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚</li>
                    <li>ä¸é©åˆ‡ãªã‚³ãƒ¡ãƒ³ãƒˆã¯äº‹å‰ã®é€šçŸ¥ãªã—ã«å‰Šé™¤ã™ã‚‹æ¨©åˆ©ã‚’ç•™ä¿ã—ã¾ã™ã€‚</li>
                    <li>ã‚¹ãƒ‘ãƒ ãŠã‚ˆã³å•†æ¥­çš„å®£ä¼ã¯ç¦æ­¢ã•ã‚Œã¦ã„ã¾ã™ã€‚</li>
                </ul>

                <h3>5. YouTube APIã‚µãƒ¼ãƒ“ã‚¹</h3>
                <p>ã“ã®ã‚µã‚¤ãƒˆã®ä½¿ç”¨ã¯ã€<a href="https://www.youtube.com/t/terms" target="_blank">YouTubeã®åˆ©ç”¨è¦ç´„</a>ãŠã‚ˆã³ãã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã«åŒæ„ã™ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚</p>

                <h3>6. å…è²¬äº‹é …</h3>
                <ul>
                    <li>ã‚µã‚¤ãƒˆã¯ã€Œç¾çŠ¶ã®ã¾ã¾ã€ä¿è¨¼ãªã—ã§æä¾›ã•ã‚Œã¾ã™ã€‚</li>
                    <li>ã‚µã‚¤ãƒˆã®ä½¿ç”¨ã‹ã‚‰ç”Ÿã˜ã‚‹æå®³ã«ã¤ã„ã¦è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
                    <li>åºƒå‘Šã«ã¯ç¬¬ä¸‰è€…ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå«ã¾ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ - ãã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ã¤ã„ã¦è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
                </ul>

                <h3>7. è¦ç´„ã®å¤‰æ›´</h3>
                <p>ã„ã¤ã§ã‚‚åˆ©ç”¨è¦ç´„ã‚’å¤‰æ›´ã™ã‚‹æ¨©åˆ©ã‚’ç•™ä¿ã—ã¾ã™ã€‚å¤‰æ›´ã¯ã“ã®ãƒšãƒ¼ã‚¸ã«æ²è¼‰ã•ã‚Œã¾ã™ã€‚</p>

                <div class="highlight-box">
                    <p><strong>âš ï¸ æ³¨æ„:</strong> å¤‰æ›´å¾Œã‚‚ã‚µã‚¤ãƒˆã‚’ç¶™ç¶šã—ã¦ä½¿ç”¨ã™ã‚‹ã¨ã€å¤‰æ›´ã•ã‚ŒãŸè¦ç´„ã«åŒæ„ã—ãŸã‚‚ã®ã¨ã¿ãªã•ã‚Œã¾ã™ã€‚</p>
                </div>

                <h3>8. ãŠå•ã„åˆã‚ã›</h3>
                <p>åˆ©ç”¨è¦ç´„ã«é–¢ã™ã‚‹ã”è³ªå•ã¯ã€ãƒ¡ãƒ¼ãƒ«ã§ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚</p>
            `;
        }

        this.show(I18n.t('termsOfService'), content);
    }
};

// ============================================
// i18n UTILITIES
// ============================================
const I18n = {
    translateElement(element) {
        if (!element) return;

        const contentKey = element.getAttribute('data-i18n-content');
        if (contentKey && i18next.exists(contentKey)) {
            element.setAttribute('content', i18next.t(contentKey));
        }

        const key = element.getAttribute('data-i18n');
        if (!key) return;

        const count = element.getAttribute('data-i18n-count');
        const options = count ? { count: parseInt(count) } : {};

        if (!i18next.exists(key)) {
            console.error(`Translation key not found: "${key}"`);
            return;
        }

        if (element.tagName !== 'INPUT' && element.tagName !== 'TEXTAREA') {
            element.textContent = i18next.t(key, options);
        }

        const placeholderKey = element.getAttribute('data-i18n-placeholder');
        if (placeholderKey && i18next.exists(placeholderKey)) {
            element.placeholder = i18next.t(placeholderKey);
        }

        const titleKey = element.getAttribute('data-i18n-title');
        if (titleKey && i18next.exists(titleKey)) {
            element.title = i18next.t(titleKey);
        }
    },

    translatePage() {
        document.querySelectorAll('[data-i18n], [data-i18n-content]').forEach(el => {
            this.translateElement(el);
        });

        const lang = i18next.language;
        document.documentElement.setAttribute('data-lang', lang);
        document.documentElement.setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');
    },

    changeLanguage(lang) {
        i18next.changeLanguage(lang, (err) => {
            if (err) {
                console.error('Language change error:', err);
                return;
            }
            localStorage.setItem('site_lang', lang);
            this.translatePage();
            App.refreshCurrentView();
        });
    },

    t(key, options = {}) {
        if (!i18next.exists(key)) {
            console.error(`Translation key not found: "${key}"`);
            return key;
        }
        return i18next.t(key, options);
    }
};

// ============================================
// UTILITIES
// ============================================
const Utils = {
    sanitize(text) {
        const d = document.createElement('div');
        d.textContent = text;
        return d.innerHTML;
    },

    timeAgo(ts) {
        const diff = Date.now() - ts;
        const m = Math.floor(diff / 60000);

        if (m < 1) return I18n.t('justNow');
        if (m < 60) return I18n.t('minutesAgo', { count: m });
        const h = Math.floor(m / 60);
        if (h < 24) return I18n.t('hoursAgo', { count: h });
        return I18n.t('daysAgo', { count: Math.floor(h / 24) });
    },

    clientId() {
        let id = localStorage.getItem('watch_vip_client_id');
        if (!id) {
            id = Date.now().toString(36) + Math.random().toString(36).slice(2);
            localStorage.setItem('watch_vip_client_id', id);
        }
        return id;
    },

    status(msg, type='info') {
        const el = document.getElementById('statusMessage');
        if (!el) return;
        el.textContent = msg;
        el.className = `status-message ${type} show`;
        setTimeout(()=>el.classList.remove('show'), 4000);
    },

    playHaptic() {
        if (navigator.vibrate) {
            navigator.vibrate(30);
        }
    }
};

// ============================================
// API
// ============================================
const API = {
    async submit(name, text) {
        try {
            const r = await fetch(`${CONFIG.BACKEND_URL}/submit-comment`, {
                method: 'POST',
                headers: {'Content-Type':'application/json'},
                body: JSON.stringify({
                    name, text,
                    clientId: Utils.clientId()
                })
            });
            if (!r.ok) throw new Error('Failed');
            return r.json();
        } catch (e) {
            throw new Error('Connection error');
        }
    },

    async comments() {
        try {
            const r = await fetch(`${CONFIG.BACKEND_URL}/comments`);
            return r.ok ? r.json() : [];
        } catch {
            return [];
        }
    }
};

// ============================================
// DUB ENGINE
// ============================================
const DubEngine = {
    state: {
        isReady: false,
        currentMode: 'original',
        mainPlayer: null,
        audioPlayers: {}
    },

    async init(mainId, versions) {
        this.cleanup();

        const container = document.getElementById('videoContainer');
        if (!container) return;

        let html = `<iframe id="dub-main"
            src="https://www.youtube.com/embed/${mainId}?enablejsapi=1&controls=1&modestbranding=1&rel=0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen></iframe>`;

        Object.entries(versions).forEach(([key, version]) => {
            if (key !== 'original') {
                html += `<iframe id="dub-${key}"
                    src="https://www.youtube.com/embed/${version.id}?enablejsapi=1&controls=0&modestbranding=1&rel=0"
                    style="display:none"
                    allow="autoplay; encrypted-media"></iframe>`;
            }
        });

        container.innerHTML = html;

        this.state.currentMode = 'original';
        this.state.isReady = false;

        if (YTReady) {
            this.setupPlayersWhenReady();
        }
    },

    setupPlayersWhenReady() {
        if (!window.YT || !window.YT.Player) {
            setTimeout(() => this.setupPlayersWhenReady(), 500);
            return;
        }

        try {
            const mainEl = document.getElementById('dub-main');
            if (mainEl) {
                this.state.mainPlayer = new YT.Player('dub-main', {
                    events: {
                        'onReady': () => {
                            this.state.isReady = true;
                            console.log('Main player ready');
                            this.updateControlButtons();
                        }
                    }
                });
            }
        } catch (e) {
            console.error('Main player error:', e);
        }

        document.querySelectorAll('[id^="dub-"]').forEach(el => {
            if (el.id === 'dub-main') return;
            
            const key = el.id.replace('dub-', '');
            try {
                this.state.audioPlayers[key] = new YT.Player(el.id, {
                    events: {
                        'onReady': () => {
                            console.log(`Audio player ${key} ready`);
                            this.updateControlButtons();
                        }
                    }
                });
            } catch (e) {
                console.error(`Audio player ${key} error:`, e);
            }
        });
    },

    setMode(mode) {
        if (mode === this.state.currentMode) return;

        try {
            if (mode === 'original') {
                if (this.state.mainPlayer && typeof this.state.mainPlayer.unMute === 'function') {
                    this.state.mainPlayer.unMute();
                }
                
                Object.values(this.state.audioPlayers).forEach(player => {
                    try {
                        if (player && typeof player.pauseVideo === 'function') {
                            player.pauseVideo();
                        }
                        if (player && typeof player.mute === 'function') {
                            player.mute();
                        }
                    } catch (e) {}
                });
            } else {
                if (this.state.mainPlayer && typeof this.state.mainPlayer.mute === 'function') {
                    this.state.mainPlayer.mute();
                }
                
                Object.entries(this.state.audioPlayers).forEach(([key, player]) => {
                    try {
                        if (!player) return;

                        if (key === mode) {
                            if (typeof player.unMute === 'function') {
                                player.unMute();
                            }
                            
                            if (this.state.mainPlayer && typeof this.state.mainPlayer.getCurrentTime === 'function') {
                                const mainTime = this.state.mainPlayer.getCurrentTime();
                                if (typeof player.seekTo === 'function') {
                                    player.seekTo(mainTime, true);
                                }
                            }
                            
                            setTimeout(() => {
                                if (this.state.mainPlayer && 
                                    this.state.mainPlayer.getPlayerState && 
                                    this.state.mainPlayer.getPlayerState() === YT.PlayerState.PLAYING &&
                                    typeof player.playVideo === 'function') {
                                    player.playVideo();
                                }
                            }, 200);
                        } else {
                            if (typeof player.pauseVideo === 'function') {
                                player.pauseVideo();
                            }
                            if (typeof player.mute === 'function') {
                                player.mute();
                            }
                        }
                    } catch (e) {}
                });
            }

            this.state.currentMode = mode;
            this.updateControlButtons();
            console.log('Mode changed to:', mode);
        } catch (e) {
            console.error('Error setting mode:', e);
        }
    },

    adjustTime(offset) {
        if (this.state.currentMode === 'original') {
            console.warn('Cannot adjust time in original mode');
            return;
        }

        const audioPlayer = this.state.audioPlayers[this.state.currentMode];
        
        if (!audioPlayer || typeof audioPlayer.seekTo !== 'function' || typeof audioPlayer.getCurrentTime !== 'function') {
            console.warn('No valid audio player for time adjustment');
            return;
        }

        try {
            const currentTime = audioPlayer.getCurrentTime();
            
            if (currentTime === undefined || isNaN(currentTime)) {
                console.warn('Invalid current time from audio player');
                return;
            }

            const newTime = Math.max(0, currentTime + offset);
            
            console.log(`Manual adjustment: ${currentTime.toFixed(2)}s -> ${newTime.toFixed(2)}s (${offset > 0 ? '+' : ''}${offset}s)`);
            
            audioPlayer.seekTo(newTime, true);
            
            Utils.playHaptic();
            
        } catch (e) {
            console.error('Error adjusting audio time:', e);
        }
    },

    updateControlButtons() {
        const controlButtons = document.querySelectorAll('#dubControls .control-btn');
        const isAudioPlayerReady = this.state.currentMode !== 'original' && 
                                   this.state.audioPlayers[this.state.currentMode];

        controlButtons.forEach(btn => {
            if (isAudioPlayerReady && this.state.isReady) {
                btn.disabled = false;
                btn.style.opacity = '1';
            } else {
                btn.disabled = true;
                btn.style.opacity = '0.3';
            }
        });
    },

    cleanup() {
        this.state.mainPlayer = null;
        this.state.audioPlayers = {};
        this.state.isReady = false;
        this.state.currentMode = 'original';
    }
};

// ============================================
// APPLICATION STATE
// ============================================
const App = {
    currentView: 'home',
    currentSeries: null,
    currentEpisode: null,
    dubEnabled: false,
    lastDubMode: localStorage.getItem('last_dub') || 'arabic',
    dubSelectorVisible: false,
    dubToggleLongPressTimer: null,

    init() {
        if (!i18next.isInitialized) {
            i18next.init({
                lng: localStorage.getItem('site_lang') || 'ar',
                fallbackLng: false,
                resources: i18nResources,
                interpolation: {
                    escapeValue: false
                }
            }).then(() => {
                I18n.translatePage();
                this.restoreState();
            });
        } else {
            I18n.translatePage();
            this.restoreState();
        }

        Comments.init();
        this.setupDubToggle();
        this.setupLanguageToggle();
        
        // Close modal on ESC key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                Modal.close();
            }
        });
    },

    restoreState() {
        const saved = sessionStorage.getItem('last_view');

        if (saved) {
            try {
                const state = JSON.parse(saved);

                if (state.view === 'video') {
                    this.currentSeries = LIBRARY.series.find(s => s.id === state.seriesId);
                    if (this.currentSeries) {
                        this.playEpisode(state.episodeId);
                    } else {
                        this.renderHome();
                    }
                } 
                else if (state.view === 'series') {
                    this.viewSeries(state.seriesId);
                } 
                else {
                    this.renderHome();
                }
            } catch (e) {
                this.renderHome();
            }
        } else {
            this.renderHome();
        }
    },

    setupLanguageToggle() {
        const langToggle = document.getElementById('langToggle');
        const langMenu = document.getElementById('langMenu');

        if (!langToggle || !langMenu) return;

        langToggle.addEventListener('click', () => {
            langMenu.classList.toggle('hidden');
        });

        document.addEventListener('click', (e) => {
            if (!langToggle.contains(e.target) && !langMenu.contains(e.target)) {
                langMenu.classList.add('hidden');
            }
        });

        langMenu.querySelectorAll('button').forEach(btn => {
            btn.addEventListener('click', () => {
                const lang = btn.getAttribute('data-lang');
                I18n.changeLanguage(lang);
                langMenu.classList.add('hidden');
                
                langMenu.querySelectorAll('button').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            });
        });

        const currentLang = i18next.language;
        langMenu.querySelector(`button[data-lang="${currentLang}"]`)?.classList.add('active');
    },

    refreshCurrentView() {
        if (this.currentView === 'home') {
            this.renderHome();
        }
        else if (this.currentView === 'series' && this.currentSeries) {
            this.viewSeries(this.currentSeries.id);
        }
        else if (this.currentView === 'video' && this.currentEpisode) {
            const episodeId = this.currentEpisode.id;
            const dubState = this.dubEnabled;
            const dubMode = this.lastDubMode;
            
            this.playEpisode(episodeId).then(() => {
                if (dubState) {
                    setTimeout(() => {
                        this.selectDubVersion(dubMode, document.querySelector(`.dub-btn[onclick*="${dubMode}"]`));
                    }, 1000);
                }
            });
        }
        
        I18n.translatePage();
    },

    setupDubToggle() {
        const btn = document.getElementById('dubToggle');
        if (!btn) return;

        let isLongPress = false;

        const handleDubToggle = () => {
            if (App.currentView !== 'video') return;
            App.toggleDub();
        };

        const handleDubMenu = () => {
            if (App.currentView !== 'video') return;
            App.toggleDubSelector();
        };

        btn.addEventListener('mousedown', () => {
            if (App.currentView !== 'video') return;
            isLongPress = false;
            App.dubToggleLongPressTimer = setTimeout(() => {
                isLongPress = true;
                handleDubMenu();
            }, CONFIG.LONG_PRESS_DURATION);
        });

        btn.addEventListener('mouseup', () => {
            if (App.dubToggleLongPressTimer) {
                clearTimeout(App.dubToggleLongPressTimer);
            }
            if (!isLongPress) {
                handleDubToggle();
            }
        });

        btn.addEventListener('touchstart', (e) => {
            if (App.currentView !== 'video') return;
            isLongPress = false;
            App.dubToggleLongPressTimer = setTimeout(() => {
                isLongPress = true;
                handleDubMenu();
            }, CONFIG.LONG_PRESS_DURATION);
        });

        btn.addEventListener('touchend', (e) => {
            if (App.dubToggleLongPressTimer) {
                clearTimeout(App.dubToggleLongPressTimer);
            }
            e.preventDefault();
            if (!isLongPress) {
                handleDubToggle();
            }
        });

        btn.addEventListener('contextmenu', (e) => e.preventDefault());
    },

    toggleDub() {
        Utils.playHaptic();
        this.dubEnabled = !this.dubEnabled;

        const btn = document.getElementById('dubToggle');
        const iconEl = btn ? btn.querySelector('.icon') : null;
        const preDubNotice = document.getElementById('preDubNotice');
        const dubControls = document.getElementById('dubControls');
        
        if (this.dubEnabled) {
            if (btn) btn.classList.add('active');
            if (iconEl) iconEl.innerHTML = '&#128266;';
            DubEngine.setMode(this.lastDubMode);
            
            if (preDubNotice) preDubNotice.classList.add('hidden');
            if (dubControls) dubControls.classList.remove('hidden');
        } else {
            if (btn) btn.classList.remove('active');
            if (iconEl) iconEl.textContent = 'X';
            DubEngine.setMode('original');
            
            if (dubControls) dubControls.classList.add('hidden');
            if (preDubNotice) preDubNotice.classList.remove('hidden');
        }
    },

    toggleDubSelector() {
        const selector = document.getElementById('dubSelector');
        if (!selector) return;

        this.dubSelectorVisible = !this.dubSelectorVisible;

        if (this.dubSelectorVisible) {
            selector.style.display = 'block';
            selector.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        } else {
            selector.style.display = 'none';
        }
    },

    renderHome() {
        const libraryView = document.getElementById('libraryView');
        const videoView = document.getElementById('videoView');
        const backBtn = document.getElementById('backBtn');

        if (libraryView) libraryView.classList.remove('hidden');
        if (videoView) videoView.classList.add('hidden');
        if (backBtn) backBtn.style.display = 'none';
        
        const breadcrumb = document.getElementById('breadcrumbText');
        if (breadcrumb) {
            breadcrumb.setAttribute('data-i18n', 'library');
            I18n.translateElement(breadcrumb);
        }

        const grid = document.getElementById('libraryGrid');
        if (grid) {
            grid.innerHTML = LIBRARY.series.map(series => `
                <div class="library-item" onclick="App.viewSeries('${series.id}')">
                    <div class="item-cover">
                        <img src="${series.cover}" alt="${I18n.t(series.titleKey)}">
                    </div>
                    <div class="item-info">
                        <div class="item-title">${Utils.sanitize(I18n.t(series.titleKey))}</div>
                        <div class="item-subtitle">${I18n.t('episodeCount', {count: series.episodes.length})}</div>
                    </div>
                </div>
            `).join('');
        }

        this.currentView = 'home';
        this.dubSelectorVisible = false;
        Comments.pauseAutoRefresh();
        DubEngine.cleanup();

        sessionStorage.removeItem('last_view');
        I18n.translatePage();
    },

    viewSeries(seriesId) {
        this.currentSeries = LIBRARY.series.find(s => s.id === seriesId);
        if (!this.currentSeries) return;

        const libraryView = document.getElementById('libraryView');
        const videoView = document.getElementById('videoView');
        const backBtn = document.getElementById('backBtn');

        if (libraryView) libraryView.classList.remove('hidden');
        if (videoView) videoView.classList.add('hidden');
        if (backBtn) {
            backBtn.style.display = 'inline-flex';
            backBtn.setAttribute('data-i18n', 'back');
            I18n.translateElement(backBtn);
        }
        
        const libraryTitle = document.getElementById('libraryTitle');
        const breadcrumbText = document.getElementById('breadcrumbText');

        if (libraryTitle) {
            libraryTitle.textContent = I18n.t(this.currentSeries.titleKey);
        }
        if (breadcrumbText) {
            breadcrumbText.textContent = I18n.t(this.currentSeries.titleKey);
        }

        const grid = document.getElementById('libraryGrid');
        if (grid) {
            grid.innerHTML = this.currentSeries.episodes.map(ep => {
                return `
                    <div class="library-item" onclick="App.playEpisode('${ep.id}')">
                        <div class="item-cover episode" style="background-image: url('${ep.cover}')">
                            <span class="play-icon">&#9658;</span>
                        </div>
                        <div class="item-info">
                            <div class="item-title">${Utils.sanitize(I18n.t(ep.titleKey))}</div>
                            <div class="item-subtitle">${Utils.sanitize(I18n.t(ep.descriptionKey))}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        this.currentView = 'series';
        this.dubSelectorVisible = false;
        Comments.pauseAutoRefresh();
        DubEngine.cleanup();

        sessionStorage.setItem('last_view', JSON.stringify({
            view: 'series',
            seriesId
        }));
        
        I18n.translatePage();
    },

    async playEpisode(episodeId) {
        if (!this.currentSeries) return;
        this.currentEpisode = this.currentSeries.episodes.find(e => e.id === episodeId);
        if (!this.currentEpisode) return;

        const libraryView = document.getElementById('libraryView');
        const videoView = document.getElementById('videoView');
        const backBtn = document.getElementById('backBtn');

        if (libraryView) libraryView.classList.add('hidden');
        if (videoView) videoView.classList.remove('hidden');
        if (backBtn) {
            backBtn.style.display = 'inline-flex';
            backBtn.setAttribute('data-i18n', 'back');
            I18n.translateElement(backBtn);
        }
        
        const breadcrumbText = document.getElementById('breadcrumbText');
        const videoTitle = document.getElementById('videoTitle');
        const videoDescription = document.getElementById('videoDescription');

        if (breadcrumbText) {
            breadcrumbText.textContent = I18n.t(this.currentEpisode.titleKey);
        }
        if (videoTitle) {
            videoTitle.textContent = I18n.t(this.currentEpisode.titleKey);
        }
        if (videoDescription) {
            videoDescription.textContent = I18n.t(this.currentEpisode.descriptionKey);
        }

        this.setupDubButtons();

        const mainId = this.currentEpisode.versions.original.id;
        await DubEngine.init(mainId, this.currentEpisode.versions);

        this.dubEnabled = false;
        this.dubSelectorVisible = false;
        
        const dubToggleBtn = document.getElementById('dubToggle');
        if (dubToggleBtn) {
            dubToggleBtn.classList.remove('active');
            const iconEl = dubToggleBtn.querySelector('.icon');
            if (iconEl) {
                iconEl.textContent = 'X';
            }
        }

        const preDubNotice = document.getElementById('preDubNotice');
        const dubControls = document.getElementById('dubControls');

        if (preDubNotice) preDubNotice.classList.remove('hidden');
        if (dubControls) dubControls.classList.add('hidden');

        this.currentView = 'video';
        Comments.load();

        sessionStorage.setItem('last_view', JSON.stringify({
            view: 'video',
            seriesId: this.currentSeries.id,
            episodeId
        }));
        
        I18n.translatePage();
    },

    setupDubButtons() {
        const versions = this.currentEpisode.versions;
        const dubButtons = document.getElementById('dubButtons');
        const dubSelector = document.getElementById('dubSelector');

        if (!dubButtons || !dubSelector) return;

        if (!versions || Object.keys(versions).length <= 1) {
            dubSelector.style.display = 'none';
            return;
        }

        dubSelector.style.display = 'none';
        this.dubSelectorVisible = false;

        dubButtons.innerHTML = Object.entries(versions).map(([key, version]) => {
            const icon = version.icon;
            const name = I18n.t(version.nameKey);
            
            return `
                <button 
                    class="dub-btn ${key === 'original' ? 'active' : ''}" 
                    onclick="App.selectDubVersion('${key}', this)"
                >
                    <span class="dub-icon">${icon}</span>
                    <span>${name}</span>
                </button>
            `;
        }).join('');

        this.updateStatusIndicator('original');
    },

    updateStatusIndicator(mode) {
        const statusText = document.getElementById('statusText');
        if (!statusText) return;
        
        const statusKeys = {
            original: 'statusOriginal',
            arabic: 'statusArabic',
            japanese: 'statusJapanese'
        };

        const icons = {
            original: '&#9658;',
            arabic: '&#128266;',
            japanese: '&#12289;&#12289;'
        };

        const statusIcon = icons[mode] || icons.original;
        const statusMessage = I18n.t(statusKeys[mode] || statusKeys.original);
        
        statusText.innerHTML = `${statusIcon} ${statusMessage}`;
    },

    selectDubVersion(versionKey, button) {
        Utils.playHaptic();

        document.querySelectorAll('.dub-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        if (button) button.classList.add('active');

        this.updateStatusIndicator(versionKey);

        const dubToggle = document.getElementById('dubToggle');
        const iconEl = dubToggle ? dubToggle.querySelector('.icon') : null;
        const preDubNotice = document.getElementById('preDubNotice');
        const dubControls = document.getElementById('dubControls');

        if (versionKey === 'original') {
            this.dubEnabled = false;
            if (dubToggle) dubToggle.classList.remove('active');
            if (iconEl) iconEl.textContent = 'X';
            DubEngine.setMode('original');
            
            if (dubControls) dubControls.classList.add('hidden');
            if (preDubNotice) preDubNotice.classList.remove('hidden');
        } else {
            this.lastDubMode = versionKey;
            localStorage.setItem('last_dub', versionKey);
            this.dubEnabled = true;
            if (dubToggle) dubToggle.classList.add('active');
            if (iconEl) iconEl.innerHTML = '&#128266;';
            DubEngine.setMode(versionKey);
            
            if (preDubNotice) preDubNotice.classList.add('hidden');
            if (dubControls) dubControls.classList.remove('hidden');
        }
    },

    goHome() {
        if (this.currentView === 'video') {
            this.viewSeries(this.currentSeries.id);
        } else if (this.currentView === 'series') {
            this.renderHome();
        }
    }
};

// ============================================
// COMMENTS MANAGER
// ============================================
const Comments = {
    userCommentId: localStorage.getItem('watch_vip_user_comment_id'),
    autoRefreshInterval: null,
    isRefreshing: false,
    lastSubmitTime: 0,

    async init() {
        const form = document.getElementById('commentForm');
        if (form) {
            form.addEventListener('submit', e => {
                e.preventDefault();
                this.send();
            });
        }

        this.startAutoRefresh();
    },

    startAutoRefresh() {
        if (this.autoRefreshInterval) clearInterval(this.autoRefreshInterval);

        const indicator = document.getElementById('updateIndicator');
        if (indicator) {
            indicator.classList.remove('paused');
        }

        this.autoRefreshInterval = setInterval(() => {
            if (App.currentView === 'video') {
                this.load();
            }
        }, CONFIG.REFRESH_INTERVAL);
    },

    pauseAutoRefresh() {
        if (this.autoRefreshInterval) {
            clearInterval(this.autoRefreshInterval);
            this.autoRefreshInterval = null;
        }

        const indicator = document.getElementById('updateIndicator');
        if (indicator) {
            indicator.classList.add('paused');
        }
    },

    async send() {
        const now = Date.now();

        if (now - this.lastSubmitTime < CONFIG.SUBMIT_COOLDOWN) {
            Utils.status(I18n.t('rateLimitError'), 'error');
            return;
        }

        if (this.userCommentId) {
            Utils.status(I18n.t('pending'), 'info');
            return;
        }

        const nameEl = document.getElementById('commentName');
        const textEl = document.getElementById('commentText');

        if (!nameEl || !textEl) return;

        const name = nameEl.value.trim();
        const text = textEl.value.trim();

        if (!text) {
            Utils.status(I18n.t('empty'), 'error');
            return;
        }

        const btn = document.getElementById('submitBtn');
        if (!btn) return;

        btn.disabled = true;
        btn.textContent = I18n.t('submitting');

        try {
            const res = await API.submit(name || null, text);
            this.userCommentId = res.commentId;
            localStorage.setItem('watch_vip_user_comment_id', res.commentId);
            this.lastSubmitTime = now;
            
            Utils.status(I18n.t('success'), 'success');
            Utils.playHaptic();
            
            textEl.value = '';
            nameEl.value = '';
            await this.load();
        } catch (e) {
            Utils.status(I18n.t('error'), 'error');
        } finally {
            btn.disabled = false;
            btn.setAttribute('data-i18n', 'submit');
            I18n.translateElement(btn);
        }
    },

    async load() {
        if (this.isRefreshing || App.currentView !== 'video') return;
        this.isRefreshing = true;

        try {
            const list = await API.comments();
            const box = document.getElementById('commentsListContainer');
            if (!box) {
                this.isRefreshing = false;
                return;
            }

            const countEl = document.getElementById('commentsCount');
            if (countEl) {
                countEl.setAttribute('data-i18n', 'commentCount');
                countEl.setAttribute('data-i18n-count', list.length);
                I18n.translateElement(countEl);
            }

            if (!list.length) {
                box.innerHTML = `<div class="no-comments" data-i18n="noComments">${I18n.t('noComments')}</div>`;
                this.isRefreshing = false;
                return;
            }

            if (this.userCommentId && !list.some(c => c.commentId === this.userCommentId)) {
                localStorage.removeItem('watch_vip_user_comment_id');
                this.userCommentId = null;
            }

            list.sort((a,b)=>{
                if (a.commentId === this.userCommentId) return -1;
                if (b.commentId === this.userCommentId) return 1;
                return b.timestamp - a.timestamp;
            });

            box.innerHTML = `
                <div class="comments-list">
                    ${list.map(c=>{
                        const isAdmin = c.clientId === CONFIG.ADMIN_CLIENT_ID;
                        const isUser = c.commentId === this.userCommentId;
                        const commentClass = isAdmin ? 'admin-comment' : (isUser ? 'user-comment' : '');
                        
                        return `
                            <div class="comment-item ${commentClass}"
                                 data-id="${c.commentId}">
                                <div class="comment-header">
                                    <div class="comment-author">
                                        ${Utils.sanitize(c.displayName)}
                                        ${isAdmin ? `<span class="admin-badge">ğŸ‘‘ ${I18n.t('adminBadge')}</span>` : ''}
                                        ${c.verified && !isAdmin ? `<svg class="verified-svg" viewBox="0 0 24 24" fill="#1da1f2">
                                            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/>
                                        </svg>` : ''}
                                    </div>
                                    <span class="comment-time">${Utils.timeAgo(c.timestamp)}</span>
                                </div>
                                <div class="comment-text">${Utils.sanitize(c.text)}</div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;

            this.bindClicks();
        } finally {
            this.isRefreshing = false;
        }
    },

    bindClicks() {
        document.querySelectorAll('.user-comment').forEach(el=>{
            let lastClick = 0;
            el.addEventListener('click', () => {
                const now = Date.now();
                if (now - lastClick < 300) {
                    localStorage.removeItem('watch_vip_user_comment_id');
                    this.userCommentId = null;
                    Utils.status(I18n.t('canComment'), 'success');
                    Utils.playHaptic();
                    this.load();
                }
                lastClick = now;
            });
        });
    }
};

// ============================================
// INITIALIZATION
// ============================================
document.addEventListener('DOMContentLoaded', () => {
    App.init();
});
    </script>
</body>
</html>
